function dhtmlXTimePicker(){this._tf='%H:%i:%s';this._bc=[];this.Rc=null;this._bcNames=['timeFormat','hours','minutes','seconds','btnApply','btnCancel'];this.hiddenSeconds=false;this.create();this.reset();};dhtmlXTimePicker.prototype={reset:function(){this._time=new Date(2008,1,1,12,0,0);this.setTime();},create:function(){this.aL=document.createElement('div');this.aL.className='dhtmlxtimepicker';this.aL.onclick=function(e){e=e||event;if(e.stopPropagation)e.stopPropagation();else e.cancelBubble=true;};var _bcCount=this._bcNames.length;var GU=this;for(var i=0;i<_bcCount;i++){if(this._bcNames[i]=='minutes'||this._bcNames[i]=='seconds'){var delimiter=document.createElement('div');delimiter.appendChild(document.createTextNode(':'));delimiter.className='delimiter';this.aL.appendChild(delimiter);}(this._bc[this._bcNames[i]]=document.createElement('div')).appendChild(document.createTextNode(''));this._bc[this._bcNames[i]].className=this._bcNames[i];this.aL.appendChild(this._bc[this._bcNames[i]]);if(this._bcNames[i]=='hours'||this._bcNames[i]=='minutes'||this._bcNames[i]=='seconds'){var upChanger=document.createElement('div');var downChanger=document.createElement('div');(function(bcName){GU._bc[bcName].onclick=function(){this.childNodes[1].onblur=this.childNodes[1].onclick;this.childNodes[1].style.display='block';};var select=document.createElement('select');select.size=7;select.onclick=select.onblur=function(e){(e||event).cancelBubble=true;this.style.display='none';this.onblur=null;GU._changeTime(bcName,this.value,0);if(GU.Rc)GU.Rc();};var optCount=bcName=='hours'?24:60;for(var j=0;j<optCount;j++){var option=document.createElement('option');option.appendChild(document.createTextNode(j));option.value=j;select.appendChild(option);}GU._bc[bcName].appendChild(select);upChanger.onclick=function(){GU._changeTime(bcName,1,1);if(GU.Rc)GU.Rc();};upChanger.onmousedown=function(){clearInterval(GU.i);GU.i=window.setInterval(function(){GU._changeTime(bcName,1,1)},200);GU.__onmouseup=document.body.onmouseup;this.onmouseup=document.body.onmouseup=function(){document.body.onmouseup=GU.__onmouseup;clearInterval(GU.i);};this.onmouseout=this.onmouseup;};downChanger.onclick=function(){GU._changeTime(bcName,1,-1);if(GU.Rc)GU.Rc();};downChanger.onmousedown=function(){clearInterval(GU.i);GU.i=window.setInterval(function(){GU._changeTime(bcName,1,-1)},200);GU.__onmouseup=document.body.onmouseup;this.onmouseup=document.body.onmouseup=function(){document.body.onmouseup=GU.__onmouseup;clearInterval(GU.i);};this.onmouseout=this.onmouseup;}})(GU._bcNames[i]);var changer=document.createElement('div');changer.className='changer';changer.appendChild(upChanger);changer.appendChild(downChanger);this.aL.appendChild(changer);}}this._setBCValue('timeFormat',this._tf);this._setBCValue('btnApply','V');this._setBCValue('btnCancel','X');this._bc['timeFormat'].onclick=function(){};document.body.appendChild(this.aL);},setTime:function(val){var EP;if(!val||isNaN((EP=new Date()).setTime(val)))EP=this._time;this._time=EP;var h=EP.getHours();var m=EP.getMinutes();var s=EP.getSeconds();this._setBCValue('hours',(h<10?'0'+h:h));this._setBCValue('minutes',(m<10?'0'+m:m));this._setBCValue('seconds',(s<10?'0'+s:s));return this._time;},setFormatedTime:function(format,EP){if(!EP)return;format=format||this._tf;var time_start_pos=format.length,time_finish_pos=0,place_holders=['H','h','i','s'];for(var i=0;i<4;i++){place_holder_pos=format.indexOf(place_holders[i]);if(place_holder_pos!= -1){time_start_pos=Math.min(time_start_pos,place_holder_pos);time_finish_pos=Math.max(time_finish_pos,place_holder_pos);}}var time_format=format.substr(time_start_pos-1,time_finish_pos-time_start_pos+2);var time_re=new RegExp(time_format.replace(/%[Hhis]/g,"\\d{1,2}"));EP=time_re.exec(EP);if(!EP)return;EP=EP[0];for(var i=0;i<time_format.length;i++){var adl=time_format.charAt(i,1);if(adl=="%"){var ahE=time_format.charAt(i+1);var val=EP.toString().substr(i,2)-0;if(isNaN(val))continue;switch(ahE){case "H":case "h":this._time.setHours(val);break;case "i":this._time.setMinutes(val);break;case "s":this._time.setSeconds(val);break;}}}return this.setTime();},setTimeFormat:function(format){this._tf=format;this.setTime();},_setBCValue:function(id,val){this._bc[id].childNodes[0].nodeValue=val;},_changeTime:function(type,value,factor){var t={h:this._time.getHours(),m:this._time.getMinutes(),s:this._time.getSeconds()};var cur=t[type.substr(0,1)];if(type=='hours')this._timeChange=60*60;else if(type=='minutes'){this._timeChange=1*60;if(t.m*factor==59||(t.m+1)*factor== -1)this._timeChange-=60*60;}else if(type=='seconds'){this._timeChange=1;if(t.s*factor==59||(t.s+1)*factor== -1)this._timeChange-=60;}this._timeChange*=factor?factor:value-cur;this.setTime(this._time.getTime()+this._timeChange*1000);},getTime:function(){return this._time;},getFormatedTime:function(format,EP){if(!EP||isNaN((EP=new Date()).setTime(EP)))EP=this._time;format=format||this._tf;var formatedTime=(format||this._tf).replace(/%(.{1})/g,function(a,b){switch(b){case 'H':var h=EP.getHours();return(h<10?'0':'')+h;case 'h':var h=EP.getHours();return(h<10?'0':'')+h-(h>12?12:0);case 'i':var m=EP.getMinutes();return(m<10?'0':'')+m;case 's':var s=EP.getSeconds();return(s<10?'0':'')+s;case 'f':return EP.getHours()>12?'PM':'AM';default:return b;}});return formatedTime;},Yy:function(x,y){with(this.aL.style){position='absolute';left=x+'px';top=y+'px';}},show:function(){this.aL.style.display='block';if(this.hiddenSeconds)this.hideSeconds()},hide:function(){this.aL.style.display='none';},hideSeconds:function(){if(this.hiddenSeconds){this._bc['seconds'].style.display='none';this._bc['seconds'].previousSibling.style.display='none';this._bc['seconds'].nextSibling.style.display='none';this._bc['hours'].style.marginLeft=((this._bc['minutes'].offsetLeft-this._bc['hours'].offsetLeft)/2-0)+'px';}this.hiddenSeconds= !this.hiddenSeconds;},ck:function(aQ){this.Rc=aQ;}}