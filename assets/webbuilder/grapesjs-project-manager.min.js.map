{"version":3,"sources":["webpack://grapesjs-project-manager/webpack/universalModuleDefinition","webpack://grapesjs-project-manager/webpack/bootstrap","webpack://grapesjs-project-manager/./node_modules/@babel/runtime/helpers/assertThisInitialized/index.js","webpack://grapesjs-project-manager/./node_modules/@babel/runtime/helpers/defineProperty/index.js","webpack://grapesjs-project-manager/./node_modules/@babel/runtime/helpers/getPrototypeOf/index.js","webpack://grapesjs-project-manager/./node_modules/@babel/runtime/helpers/classCallCheck/index.js","webpack://grapesjs-project-manager/./node_modules/@babel/runtime/helpers/createClass/index.js","webpack://grapesjs-project-manager/./node_modules/@babel/runtime/helpers/inherits/index.js","webpack://grapesjs-project-manager/./node_modules/@babel/runtime/helpers/possibleConstructorReturn/index.js","webpack://grapesjs-project-manager/./node_modules/@babel/runtime/helpers/objectWithoutProperties/index.js","webpack://grapesjs-project-manager/./node_modules/@babel/runtime/helpers/readOnlyError/index.js","webpack://grapesjs-project-manager/./node_modules/@babel/runtime/helpers/toConsumableArray/index.js","webpack://grapesjs-project-manager/./node_modules/dom-to-image/src/dom-to-image.js","webpack://grapesjs-project-manager/./node_modules/@babel/runtime/helpers/arrayLikeToArray/index.js","webpack://grapesjs-project-manager/./node_modules/@babel/runtime/helpers/setPrototypeOf/index.js","webpack://grapesjs-project-manager/./node_modules/@babel/runtime/helpers/typeof/index.js","webpack://grapesjs-project-manager/./node_modules/@babel/runtime/helpers/arrayWithoutHoles/index.js","webpack://grapesjs-project-manager/./node_modules/@babel/runtime/helpers/iterableToArray/index.js","webpack://grapesjs-project-manager/./node_modules/@babel/runtime/helpers/unsupportedIterableToArray/index.js","webpack://grapesjs-project-manager/./node_modules/@babel/runtime/helpers/nonIterableSpread/index.js","webpack://grapesjs-project-manager/./node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose/index.js","webpack://grapesjs-project-manager/./src/utils/timeago.js","webpack://grapesjs-project-manager/./src/utils/ui.js","webpack://grapesjs-project-manager/./src/utils/objsize.js","webpack://grapesjs-project-manager/./src/utils/sort.js","webpack://grapesjs-project-manager/./src/manager/templates.js","webpack://grapesjs-project-manager/./src/manager/pages.js","webpack://grapesjs-project-manager/./src/manager/settings.js","webpack://grapesjs-project-manager/./src/manager/index.js","webpack://grapesjs-project-manager/./src/commands.js","webpack://grapesjs-project-manager/./src/consts.js","webpack://grapesjs-project-manager/./src/storage/indexeddb.js","webpack://grapesjs-project-manager/./src/storage/remote.js","webpack://grapesjs-project-manager/./src/storage/firestore.js","webpack://grapesjs-project-manager/./src/storage/index.js","webpack://grapesjs-project-manager/./src/locale/en.js","webpack://grapesjs-project-manager/./src/index.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","self","ReferenceError","obj","configurable","writable","_getPrototypeOf","setPrototypeOf","getPrototypeOf","__proto__","instance","Constructor","TypeError","_defineProperties","target","props","length","descriptor","protoProps","staticProps","subClass","superClass","constructor","_typeof","assertThisInitialized","objectWithoutPropertiesLoose","source","excluded","getOwnPropertySymbols","sourceSymbolKeys","indexOf","propertyIsEnumerable","arrayWithoutHoles","iterableToArray","unsupportedIterableToArray","nonIterableSpread","arr","global","util","escape","string","replace","parseExtension","mimeType","url","extension","toLowerCase","WOFF","JPEG","dataAsUrl","content","type","isDataUrl","search","canvasToBlob","canvas","toBlob","Promise","resolve","binaryString","atob","toDataURL","split","binaryArray","Uint8Array","charCodeAt","Blob","resolveUrl","baseUrl","doc","document","implementation","createHTMLDocument","base","createElement","head","appendChild","a","body","href","getAndEncode","TIMEOUT","domtoimage","impl","options","cacheBust","test","Date","getTime","placeholder","request","XMLHttpRequest","onreadystatechange","readyState","status","fail","encoder","FileReader","onloadend","result","readAsDataURL","response","ontimeout","responseType","timeout","open","send","imagePlaceholder","message","console","error","uid","index","Math","random","pow","toString","slice","delay","ms","arg","setTimeout","asArray","arrayLike","array","push","escapeXhtml","makeImage","uri","reject","image","Image","onload","onerror","src","width","node","leftBorder","px","rightBorder","scrollWidth","height","topBorder","bottomBorder","scrollHeight","match","exec","styleProperty","getComputedStyle","getPropertyValue","parseFloat","newUtil","inliner","URL_REGEX","inlineAll","shouldProcess","nothingToInline","then","readUrls","urls","done","forEach","inline","filter","data","dataUrl","RegExp","urlAsRegex","newInliner","fontFaces","resolveAll","readAll","webFonts","all","map","webFont","cssStrings","join","styleSheets","cssRules","sheet","e","log","rule","CSSRule","FONT_FACE_RULE","style","rules","newWebFont","webFontRule","parentStyleSheet","cssText","newFontFaces","images","Element","background","inlined","setProperty","getPropertyPriority","inlineBackground","HTMLImageElement","newImage","childNodes","child","element","newImages","defaultOptions","undefined","toSvg","toPng","draw","toJpeg","quality","toPixelData","getContext","getImageData","copyOptions","cloneNode","HTMLCanvasElement","clone","cloneChildren","original","cloneStyle","clonePseudoElements","copyUserInput","fixSvg","copyProperties","className","styleElement","selector","formatCssText","formatCssProperties","createTextNode","formatPseudoElementStyle","clonePseudoElement","HTMLTextAreaElement","innerHTML","HTMLInputElement","setAttribute","SVGElement","SVGRectElement","attribute","getAttribute","processClone","children","cloneChildrenInOrder","parent","childClone","embedFonts","inlineImages","bgcolor","backgroundColor","keys","XMLSerializer","serializeToString","xhtml","foreignObject","svg","makeSvgDataUri","domNode","ctx","fillStyle","fillRect","newCanvas","drawImage","styleNode","len","arr2","Array","_setPrototypeOf","iterator","arrayLikeToArray","isArray","iter","from","minLen","sourceKeys","timeago","date","short","ii","second","minute","hour","day","week","month","year","round","dir","pl","v","substring","ts","now","UI","editor","opts","this","$","pfx","getConfig","id","Storage","setState","setStateSilent","onRender","handleTabs","state","update","getCurrentStorage","Pages","objSizeKiloBytes","objSizeBytes","TextEncoder","encode","JSON","stringify","matchText","text","TemplateManager","handleSort","handleFilterInput","handleNameInput","handleOpen","handleCreate","handleDelete","openEdit","editableProjectId","projectId","tab","sites","nameText","filterText","loading","sortBy","sortOrder","objSize","cs","loadAll","err","trim","dataset","sort","$el","find","removeClass","addClass","currentId","setId","load","res","setName","setThumbnail","thumbnail","setIsTemplate","template","setDescription","description","Modal","close","currentPageOpen","runCommand","substr","def","styles","store","currentTarget","SettingsApp","setTab","updated_at","delete","onDelete","onDeleteError","order","loader","nosites","b","sortByName","dateType","timeA","timeB","sortByDate","pagesA","parse","pagesB","sortByPages","sizeA","sizeB","sortBySize","matchingSites","site","created_at","size","pages","time","ago","createdAt","pageNames","page","I18n","toFixed","html","css","renderSiteList","renderSiteActions","on","val","remove","cont","PagesApp","addPage","selectPage","removePage","isSelected","editablePageId","isShowing","pm","getAll","getSelected","select","currentPage","set","add","component","renderPagesList","Panels","getPanel","findPanel","render","trigger","handleSave","handleThumbnail","handleThumbnailInput","renderSettings","editableId","editPage","checked","handleEdit","clb","attr","allSites","cm","Commands","mdl","mdlClass","mdlClassMd","run","sender","mdlDialog","querySelector","classList","setTitle","mdlTitle","setContent","getModel","once","showPanel","stop","hidePanel","uuidv4","crypto","getRandomValues","getJpeg","clbErr","catch","el","getWrapper","getEl","getStyle","onScreenshotError","storageIDB","storageRemote","storageFireStore","db","sm","StorageManager","storageName","objsName","objectStoreName","getDb","getAsyncDb","indexedDB","mozIndexedDB","webkitIndexedDB","msIndexedDB","dbName","indexeddbVersion","onError","errorCode","onsuccess","onupgradeneeded","createObjectStore","keyPath","createIndex","unique","getObjectStore","transaction","objectStore","getAsyncObjectStore","currentName","currentThumbnail","isTemplate","objs","put","_data","remote","urlLoad","endsWith","urlStore","uuidInPath","urlUpdate","method","urlDelete","collection","apiKey","authDomain","dbSettings","settings","getDoc","getAsyncCollection","firebase","apps","app","firestore","initializeApp","firebaseConfig","getAsyncDoc","cll","setDocId","clbError","exists","docs","merge","indexeddb","templates","new","help","info","updated","created","actions","titles","edit","save","generate","labels","placeholders","loadFirst","nopages","enableOffline","timestampsInSnapshots","i18n","addMessages","en","commands","storage","firstPage","components","setComponents","setStyle"],"mappings":"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","file":"grapesjs-project-manager.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"grapesjs-project-manager\"] = factory();\n\telse\n\t\troot[\"grapesjs-project-manager\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 19);\n","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var setPrototypeOf = require(\"@babel/runtime/helpers/setPrototypeOf\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var _typeof = require(\"@babel/runtime/helpers/typeof\")[\"default\"];\n\nvar assertThisInitialized = require(\"@babel/runtime/helpers/assertThisInitialized\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var objectWithoutPropertiesLoose = require(\"@babel/runtime/helpers/objectWithoutPropertiesLoose\");\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutProperties;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _readOnlyError(name) {\n  throw new TypeError(\"\\\"\" + name + \"\\\" is read-only\");\n}\n\nmodule.exports = _readOnlyError;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var arrayWithoutHoles = require(\"@babel/runtime/helpers/arrayWithoutHoles\");\n\nvar iterableToArray = require(\"@babel/runtime/helpers/iterableToArray\");\n\nvar unsupportedIterableToArray = require(\"@babel/runtime/helpers/unsupportedIterableToArray\");\n\nvar nonIterableSpread = require(\"@babel/runtime/helpers/nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","(function (global) {\n    'use strict';\n\n    var util = newUtil();\n    var inliner = newInliner();\n    var fontFaces = newFontFaces();\n    var images = newImages();\n\n    // Default impl options\n    var defaultOptions = {\n        // Default is to fail on error, no placeholder\n        imagePlaceholder: undefined,\n        // Default cache bust is false, it will use the cache\n        cacheBust: false\n    };\n\n    var domtoimage = {\n        toSvg: toSvg,\n        toPng: toPng,\n        toJpeg: toJpeg,\n        toBlob: toBlob,\n        toPixelData: toPixelData,\n        impl: {\n            fontFaces: fontFaces,\n            images: images,\n            util: util,\n            inliner: inliner,\n            options: {}\n        }\n    };\n\n    if (typeof module !== 'undefined')\n        module.exports = domtoimage;\n    else\n        global.domtoimage = domtoimage;\n\n\n    /**\n     * @param {Node} node - The DOM Node object to render\n     * @param {Object} options - Rendering options\n     * @param {Function} options.filter - Should return true if passed node should be included in the output\n     *          (excluding node means excluding it's children as well). Not called on the root node.\n     * @param {String} options.bgcolor - color for the background, any valid CSS color value.\n     * @param {Number} options.width - width to be applied to node before rendering.\n     * @param {Number} options.height - height to be applied to node before rendering.\n     * @param {Object} options.style - an object whose properties to be copied to node's style before rendering.\n     * @param {Number} options.quality - a Number between 0 and 1 indicating image quality (applicable to JPEG only),\n                defaults to 1.0.\n     * @param {String} options.imagePlaceholder - dataURL to use as a placeholder for failed images, default behaviour is to fail fast on images we can't fetch\n     * @param {Boolean} options.cacheBust - set to true to cache bust by appending the time to the request url\n     * @return {Promise} - A promise that is fulfilled with a SVG image data URL\n     * */\n    function toSvg(node, options) {\n        options = options || {};\n        copyOptions(options);\n        return Promise.resolve(node)\n            .then(function (node) {\n                return cloneNode(node, options.filter, true);\n            })\n            .then(embedFonts)\n            .then(inlineImages)\n            .then(applyOptions)\n            .then(function (clone) {\n                return makeSvgDataUri(clone,\n                    options.width || util.width(node),\n                    options.height || util.height(node)\n                );\n            });\n\n        function applyOptions(clone) {\n            if (options.bgcolor) clone.style.backgroundColor = options.bgcolor;\n\n            if (options.width) clone.style.width = options.width + 'px';\n            if (options.height) clone.style.height = options.height + 'px';\n\n            if (options.style)\n                Object.keys(options.style).forEach(function (property) {\n                    clone.style[property] = options.style[property];\n                });\n\n            return clone;\n        }\n    }\n\n    /**\n     * @param {Node} node - The DOM Node object to render\n     * @param {Object} options - Rendering options, @see {@link toSvg}\n     * @return {Promise} - A promise that is fulfilled with a Uint8Array containing RGBA pixel data.\n     * */\n    function toPixelData(node, options) {\n        return draw(node, options || {})\n            .then(function (canvas) {\n                return canvas.getContext('2d').getImageData(\n                    0,\n                    0,\n                    util.width(node),\n                    util.height(node)\n                ).data;\n            });\n    }\n\n    /**\n     * @param {Node} node - The DOM Node object to render\n     * @param {Object} options - Rendering options, @see {@link toSvg}\n     * @return {Promise} - A promise that is fulfilled with a PNG image data URL\n     * */\n    function toPng(node, options) {\n        return draw(node, options || {})\n            .then(function (canvas) {\n                return canvas.toDataURL();\n            });\n    }\n\n    /**\n     * @param {Node} node - The DOM Node object to render\n     * @param {Object} options - Rendering options, @see {@link toSvg}\n     * @return {Promise} - A promise that is fulfilled with a JPEG image data URL\n     * */\n    function toJpeg(node, options) {\n        options = options || {};\n        return draw(node, options)\n            .then(function (canvas) {\n                return canvas.toDataURL('image/jpeg', options.quality || 1.0);\n            });\n    }\n\n    /**\n     * @param {Node} node - The DOM Node object to render\n     * @param {Object} options - Rendering options, @see {@link toSvg}\n     * @return {Promise} - A promise that is fulfilled with a PNG image blob\n     * */\n    function toBlob(node, options) {\n        return draw(node, options || {})\n            .then(util.canvasToBlob);\n    }\n\n    function copyOptions(options) {\n        // Copy options to impl options for use in impl\n        if(typeof(options.imagePlaceholder) === 'undefined') {\n            domtoimage.impl.options.imagePlaceholder = defaultOptions.imagePlaceholder;\n        } else {\n            domtoimage.impl.options.imagePlaceholder = options.imagePlaceholder;\n        }\n\n        if(typeof(options.cacheBust) === 'undefined') {\n            domtoimage.impl.options.cacheBust = defaultOptions.cacheBust;\n        } else {\n            domtoimage.impl.options.cacheBust = options.cacheBust;\n        }\n    }\n\n    function draw(domNode, options) {\n        return toSvg(domNode, options)\n            .then(util.makeImage)\n            .then(util.delay(100))\n            .then(function (image) {\n                var canvas = newCanvas(domNode);\n                canvas.getContext('2d').drawImage(image, 0, 0);\n                return canvas;\n            });\n\n        function newCanvas(domNode) {\n            var canvas = document.createElement('canvas');\n            canvas.width = options.width || util.width(domNode);\n            canvas.height = options.height || util.height(domNode);\n\n            if (options.bgcolor) {\n                var ctx = canvas.getContext('2d');\n                ctx.fillStyle = options.bgcolor;\n                ctx.fillRect(0, 0, canvas.width, canvas.height);\n            }\n\n            return canvas;\n        }\n    }\n\n    function cloneNode(node, filter, root) {\n        if (!root && filter && !filter(node)) return Promise.resolve();\n\n        return Promise.resolve(node)\n            .then(makeNodeCopy)\n            .then(function (clone) {\n                return cloneChildren(node, clone, filter);\n            })\n            .then(function (clone) {\n                return processClone(node, clone);\n            });\n\n        function makeNodeCopy(node) {\n            if (node instanceof HTMLCanvasElement) return util.makeImage(node.toDataURL());\n            return node.cloneNode(false);\n        }\n\n        function cloneChildren(original, clone, filter) {\n            var children = original.childNodes;\n            if (children.length === 0) return Promise.resolve(clone);\n\n            return cloneChildrenInOrder(clone, util.asArray(children), filter)\n                .then(function () {\n                    return clone;\n                });\n\n            function cloneChildrenInOrder(parent, children, filter) {\n                var done = Promise.resolve();\n                children.forEach(function (child) {\n                    done = done\n                        .then(function () {\n                            return cloneNode(child, filter);\n                        })\n                        .then(function (childClone) {\n                            if (childClone) parent.appendChild(childClone);\n                        });\n                });\n                return done;\n            }\n        }\n\n        function processClone(original, clone) {\n            if (!(clone instanceof Element)) return clone;\n\n            return Promise.resolve()\n                .then(cloneStyle)\n                .then(clonePseudoElements)\n                .then(copyUserInput)\n                .then(fixSvg)\n                .then(function () {\n                    return clone;\n                });\n\n            function cloneStyle() {\n                copyStyle(window.getComputedStyle(original), clone.style);\n\n                function copyStyle(source, target) {\n                    if (source.cssText) target.cssText = source.cssText;\n                    else copyProperties(source, target);\n\n                    function copyProperties(source, target) {\n                        util.asArray(source).forEach(function (name) {\n                            target.setProperty(\n                                name,\n                                source.getPropertyValue(name),\n                                source.getPropertyPriority(name)\n                            );\n                        });\n                    }\n                }\n            }\n\n            function clonePseudoElements() {\n                [':before', ':after'].forEach(function (element) {\n                    clonePseudoElement(element);\n                });\n\n                function clonePseudoElement(element) {\n                    var style = window.getComputedStyle(original, element);\n                    var content = style.getPropertyValue('content');\n\n                    if (content === '' || content === 'none') return;\n\n                    var className = util.uid();\n                    clone.className = clone.className + ' ' + className;\n                    var styleElement = document.createElement('style');\n                    styleElement.appendChild(formatPseudoElementStyle(className, element, style));\n                    clone.appendChild(styleElement);\n\n                    function formatPseudoElementStyle(className, element, style) {\n                        var selector = '.' + className + ':' + element;\n                        var cssText = style.cssText ? formatCssText(style) : formatCssProperties(style);\n                        return document.createTextNode(selector + '{' + cssText + '}');\n\n                        function formatCssText(style) {\n                            var content = style.getPropertyValue('content');\n                            return style.cssText + ' content: ' + content + ';';\n                        }\n\n                        function formatCssProperties(style) {\n\n                            return util.asArray(style)\n                                .map(formatProperty)\n                                .join('; ') + ';';\n\n                            function formatProperty(name) {\n                                return name + ': ' +\n                                    style.getPropertyValue(name) +\n                                    (style.getPropertyPriority(name) ? ' !important' : '');\n                            }\n                        }\n                    }\n                }\n            }\n\n            function copyUserInput() {\n                if (original instanceof HTMLTextAreaElement) clone.innerHTML = original.value;\n                if (original instanceof HTMLInputElement) clone.setAttribute(\"value\", original.value);\n            }\n\n            function fixSvg() {\n                if (!(clone instanceof SVGElement)) return;\n                clone.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n\n                if (!(clone instanceof SVGRectElement)) return;\n                ['width', 'height'].forEach(function (attribute) {\n                    var value = clone.getAttribute(attribute);\n                    if (!value) return;\n\n                    clone.style.setProperty(attribute, value);\n                });\n            }\n        }\n    }\n\n    function embedFonts(node) {\n        return fontFaces.resolveAll()\n            .then(function (cssText) {\n                var styleNode = document.createElement('style');\n                node.appendChild(styleNode);\n                styleNode.appendChild(document.createTextNode(cssText));\n                return node;\n            });\n    }\n\n    function inlineImages(node) {\n        return images.inlineAll(node)\n            .then(function () {\n                return node;\n            });\n    }\n\n    function makeSvgDataUri(node, width, height) {\n        return Promise.resolve(node)\n            .then(function (node) {\n                node.setAttribute('xmlns', 'http://www.w3.org/1999/xhtml');\n                return new XMLSerializer().serializeToString(node);\n            })\n            .then(util.escapeXhtml)\n            .then(function (xhtml) {\n                return '<foreignObject x=\"0\" y=\"0\" width=\"100%\" height=\"100%\">' + xhtml + '</foreignObject>';\n            })\n            .then(function (foreignObject) {\n                return '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"' + width + '\" height=\"' + height + '\">' +\n                    foreignObject + '</svg>';\n            })\n            .then(function (svg) {\n                return 'data:image/svg+xml;charset=utf-8,' + svg;\n            });\n    }\n\n    function newUtil() {\n        return {\n            escape: escape,\n            parseExtension: parseExtension,\n            mimeType: mimeType,\n            dataAsUrl: dataAsUrl,\n            isDataUrl: isDataUrl,\n            canvasToBlob: canvasToBlob,\n            resolveUrl: resolveUrl,\n            getAndEncode: getAndEncode,\n            uid: uid(),\n            delay: delay,\n            asArray: asArray,\n            escapeXhtml: escapeXhtml,\n            makeImage: makeImage,\n            width: width,\n            height: height\n        };\n\n        function mimes() {\n            /*\n             * Only WOFF and EOT mime types for fonts are 'real'\n             * see http://www.iana.org/assignments/media-types/media-types.xhtml\n             */\n            var WOFF = 'application/font-woff';\n            var JPEG = 'image/jpeg';\n\n            return {\n                'woff': WOFF,\n                'woff2': WOFF,\n                'ttf': 'application/font-truetype',\n                'eot': 'application/vnd.ms-fontobject',\n                'png': 'image/png',\n                'jpg': JPEG,\n                'jpeg': JPEG,\n                'gif': 'image/gif',\n                'tiff': 'image/tiff',\n                'svg': 'image/svg+xml'\n            };\n        }\n\n        function parseExtension(url) {\n            var match = /\\.([^\\.\\/]*?)$/g.exec(url);\n            if (match) return match[1];\n            else return '';\n        }\n\n        function mimeType(url) {\n            var extension = parseExtension(url).toLowerCase();\n            return mimes()[extension] || '';\n        }\n\n        function isDataUrl(url) {\n            return url.search(/^(data:)/) !== -1;\n        }\n\n        function toBlob(canvas) {\n            return new Promise(function (resolve) {\n                var binaryString = window.atob(canvas.toDataURL().split(',')[1]);\n                var length = binaryString.length;\n                var binaryArray = new Uint8Array(length);\n\n                for (var i = 0; i < length; i++)\n                    binaryArray[i] = binaryString.charCodeAt(i);\n\n                resolve(new Blob([binaryArray], {\n                    type: 'image/png'\n                }));\n            });\n        }\n\n        function canvasToBlob(canvas) {\n            if (canvas.toBlob)\n                return new Promise(function (resolve) {\n                    canvas.toBlob(resolve);\n                });\n\n            return toBlob(canvas);\n        }\n\n        function resolveUrl(url, baseUrl) {\n            var doc = document.implementation.createHTMLDocument();\n            var base = doc.createElement('base');\n            doc.head.appendChild(base);\n            var a = doc.createElement('a');\n            doc.body.appendChild(a);\n            base.href = baseUrl;\n            a.href = url;\n            return a.href;\n        }\n\n        function uid() {\n            var index = 0;\n\n            return function () {\n                return 'u' + fourRandomChars() + index++;\n\n                function fourRandomChars() {\n                    /* see http://stackoverflow.com/a/6248722/2519373 */\n                    return ('0000' + (Math.random() * Math.pow(36, 4) << 0).toString(36)).slice(-4);\n                }\n            };\n        }\n\n        function makeImage(uri) {\n            return new Promise(function (resolve, reject) {\n                var image = new Image();\n                image.onload = function () {\n                    resolve(image);\n                };\n                image.onerror = reject;\n                image.src = uri;\n            });\n        }\n\n        function getAndEncode(url) {\n            var TIMEOUT = 30000;\n            if(domtoimage.impl.options.cacheBust) {\n                // Cache bypass so we dont have CORS issues with cached images\n                // Source: https://developer.mozilla.org/en/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest#Bypassing_the_cache\n                url += ((/\\?/).test(url) ? \"&\" : \"?\") + (new Date()).getTime();\n            }\n\n            return new Promise(function (resolve) {\n                var request = new XMLHttpRequest();\n\n                request.onreadystatechange = done;\n                request.ontimeout = timeout;\n                request.responseType = 'blob';\n                request.timeout = TIMEOUT;\n                request.open('GET', url, true);\n                request.send();\n\n                var placeholder;\n                if(domtoimage.impl.options.imagePlaceholder) {\n                    var split = domtoimage.impl.options.imagePlaceholder.split(/,/);\n                    if(split && split[1]) {\n                        placeholder = split[1];\n                    }\n                }\n\n                function done() {\n                    if (request.readyState !== 4) return;\n\n                    if (request.status !== 200) {\n                        if(placeholder) {\n                            resolve(placeholder);\n                        } else {\n                            fail('cannot fetch resource: ' + url + ', status: ' + request.status);\n                        }\n\n                        return;\n                    }\n\n                    var encoder = new FileReader();\n                    encoder.onloadend = function () {\n                        var content = encoder.result.split(/,/)[1];\n                        resolve(content);\n                    };\n                    encoder.readAsDataURL(request.response);\n                }\n\n                function timeout() {\n                    if(placeholder) {\n                        resolve(placeholder);\n                    } else {\n                        fail('timeout of ' + TIMEOUT + 'ms occured while fetching resource: ' + url);\n                    }\n                }\n\n                function fail(message) {\n                    console.error(message);\n                    resolve('');\n                }\n            });\n        }\n\n        function dataAsUrl(content, type) {\n            return 'data:' + type + ';base64,' + content;\n        }\n\n        function escape(string) {\n            return string.replace(/([.*+?^${}()|\\[\\]\\/\\\\])/g, '\\\\$1');\n        }\n\n        function delay(ms) {\n            return function (arg) {\n                return new Promise(function (resolve) {\n                    setTimeout(function () {\n                        resolve(arg);\n                    }, ms);\n                });\n            };\n        }\n\n        function asArray(arrayLike) {\n            var array = [];\n            var length = arrayLike.length;\n            for (var i = 0; i < length; i++) array.push(arrayLike[i]);\n            return array;\n        }\n\n        function escapeXhtml(string) {\n            return string.replace(/#/g, '%23').replace(/\\n/g, '%0A');\n        }\n\n        function width(node) {\n            var leftBorder = px(node, 'border-left-width');\n            var rightBorder = px(node, 'border-right-width');\n            return node.scrollWidth + leftBorder + rightBorder;\n        }\n\n        function height(node) {\n            var topBorder = px(node, 'border-top-width');\n            var bottomBorder = px(node, 'border-bottom-width');\n            return node.scrollHeight + topBorder + bottomBorder;\n        }\n\n        function px(node, styleProperty) {\n            var value = window.getComputedStyle(node).getPropertyValue(styleProperty);\n            return parseFloat(value.replace('px', ''));\n        }\n    }\n\n    function newInliner() {\n        var URL_REGEX = /url\\(['\"]?([^'\"]+?)['\"]?\\)/g;\n\n        return {\n            inlineAll: inlineAll,\n            shouldProcess: shouldProcess,\n            impl: {\n                readUrls: readUrls,\n                inline: inline\n            }\n        };\n\n        function shouldProcess(string) {\n            return string.search(URL_REGEX) !== -1;\n        }\n\n        function readUrls(string) {\n            var result = [];\n            var match;\n            while ((match = URL_REGEX.exec(string)) !== null) {\n                result.push(match[1]);\n            }\n            return result.filter(function (url) {\n                return !util.isDataUrl(url);\n            });\n        }\n\n        function inline(string, url, baseUrl, get) {\n            return Promise.resolve(url)\n                .then(function (url) {\n                    return baseUrl ? util.resolveUrl(url, baseUrl) : url;\n                })\n                .then(get || util.getAndEncode)\n                .then(function (data) {\n                    return util.dataAsUrl(data, util.mimeType(url));\n                })\n                .then(function (dataUrl) {\n                    return string.replace(urlAsRegex(url), '$1' + dataUrl + '$3');\n                });\n\n            function urlAsRegex(url) {\n                return new RegExp('(url\\\\([\\'\"]?)(' + util.escape(url) + ')([\\'\"]?\\\\))', 'g');\n            }\n        }\n\n        function inlineAll(string, baseUrl, get) {\n            if (nothingToInline()) return Promise.resolve(string);\n\n            return Promise.resolve(string)\n                .then(readUrls)\n                .then(function (urls) {\n                    var done = Promise.resolve(string);\n                    urls.forEach(function (url) {\n                        done = done.then(function (string) {\n                            return inline(string, url, baseUrl, get);\n                        });\n                    });\n                    return done;\n                });\n\n            function nothingToInline() {\n                return !shouldProcess(string);\n            }\n        }\n    }\n\n    function newFontFaces() {\n        return {\n            resolveAll: resolveAll,\n            impl: {\n                readAll: readAll\n            }\n        };\n\n        function resolveAll() {\n            return readAll(document)\n                .then(function (webFonts) {\n                    return Promise.all(\n                        webFonts.map(function (webFont) {\n                            return webFont.resolve();\n                        })\n                    );\n                })\n                .then(function (cssStrings) {\n                    return cssStrings.join('\\n');\n                });\n        }\n\n        function readAll() {\n            return Promise.resolve(util.asArray(document.styleSheets))\n                .then(getCssRules)\n                .then(selectWebFontRules)\n                .then(function (rules) {\n                    return rules.map(newWebFont);\n                });\n\n            function selectWebFontRules(cssRules) {\n                return cssRules\n                    .filter(function (rule) {\n                        return rule.type === CSSRule.FONT_FACE_RULE;\n                    })\n                    .filter(function (rule) {\n                        return inliner.shouldProcess(rule.style.getPropertyValue('src'));\n                    });\n            }\n\n            function getCssRules(styleSheets) {\n                var cssRules = [];\n                styleSheets.forEach(function (sheet) {\n                    try {\n                        util.asArray(sheet.cssRules || []).forEach(cssRules.push.bind(cssRules));\n                    } catch (e) {\n                        console.log('Error while reading CSS rules from ' + sheet.href, e.toString());\n                    }\n                });\n                return cssRules;\n            }\n\n            function newWebFont(webFontRule) {\n                return {\n                    resolve: function resolve() {\n                        var baseUrl = (webFontRule.parentStyleSheet || {}).href;\n                        return inliner.inlineAll(webFontRule.cssText, baseUrl);\n                    },\n                    src: function () {\n                        return webFontRule.style.getPropertyValue('src');\n                    }\n                };\n            }\n        }\n    }\n\n    function newImages() {\n        return {\n            inlineAll: inlineAll,\n            impl: {\n                newImage: newImage\n            }\n        };\n\n        function newImage(element) {\n            return {\n                inline: inline\n            };\n\n            function inline(get) {\n                if (util.isDataUrl(element.src)) return Promise.resolve();\n\n                return Promise.resolve(element.src)\n                    .then(get || util.getAndEncode)\n                    .then(function (data) {\n                        return util.dataAsUrl(data, util.mimeType(element.src));\n                    })\n                    .then(function (dataUrl) {\n                        return new Promise(function (resolve, reject) {\n                            element.onload = resolve;\n                            element.onerror = reject;\n                            element.src = dataUrl;\n                        });\n                    });\n            }\n        }\n\n        function inlineAll(node) {\n            if (!(node instanceof Element)) return Promise.resolve(node);\n\n            return inlineBackground(node)\n                .then(function () {\n                    if (node instanceof HTMLImageElement)\n                        return newImage(node).inline();\n                    else\n                        return Promise.all(\n                            util.asArray(node.childNodes).map(function (child) {\n                                return inlineAll(child);\n                            })\n                        );\n                });\n\n            function inlineBackground(node) {\n                var background = node.style.getPropertyValue('background');\n\n                if (!background) return Promise.resolve(node);\n\n                return inliner.inlineAll(background)\n                    .then(function (inlined) {\n                        node.style.setProperty(\n                            'background',\n                            inlined,\n                            node.style.getPropertyPriority('background')\n                        );\n                    })\n                    .then(function () {\n                        return node;\n                    });\n            }\n        }\n    }\n})(this);\n","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n\n    module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n\n    module.exports[\"default\"] = module.exports, module.exports.__esModule = true;\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var arrayLikeToArray = require(\"@babel/runtime/helpers/arrayLikeToArray\");\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\n\nmodule.exports = _arrayWithoutHoles;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","var arrayLikeToArray = require(\"@babel/runtime/helpers/arrayLikeToArray\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableSpread;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutPropertiesLoose;\nmodule.exports[\"default\"] = module.exports, module.exports.__esModule = true;","export default function timeago(date, short) {\r\n    const obj = {\r\n        second: 1000,\r\n        minute: 60 * 1000,\r\n        hour: 60 * 1000 * 60,\r\n        day: 24 * 60 * 1000 * 60,\r\n        week: 7 * 24 * 60 * 1000 * 60,\r\n        month: 30 * 24 * 60 * 1000 * 60,\r\n        year: 365 * 24 * 60 * 1000 * 60,\r\n    }\r\n\r\n    const { round } = Math,\r\n        dir = ' ago',\r\n        pl = function (v, n) {\r\n            return (short === undefined) ? `${n} ${v + (n > 1 ? 's' : '') + dir}` : n + v.substring(0, 1)\r\n        },\r\n        ts = Date.now() - new Date(date).getTime();\r\n    let ii;\r\n\r\n    if (ts < 0) {\r\n        ts *= -1;\r\n        dir = ' from now';\r\n    }\r\n\r\n    for (var i in obj) {\r\n        if (round(ts) < 0[i]) return pl(ii || 'm', round(ts / (obj[ii] || 1)))\r\n        ii = i;\r\n    }\r\n    return pl(i, round(ts / obj[i]));\r\n}","export default class UI {\r\n    constructor(editor, opts = {}) {\r\n        this.editor = editor;\r\n        this.$ = editor.$;\r\n        this.pfx = editor.getConfig('stylePrefix');\r\n        this.id = editor.Storage.getConfig().id;\r\n        this.opts = opts;\r\n        this.setState = this.setState.bind(this);\r\n        this.setStateSilent = this.setStateSilent.bind(this);\r\n        this.onRender = this.onRender.bind(this);\r\n        this.handleTabs = this.handleTabs.bind(this);\r\n    }\r\n\r\n    setState(state) {\r\n        this.state = { ...this.state, ...state };\r\n        this.update();\r\n    }\r\n\r\n    setStateSilent(state) {\r\n        this.state = { ...this.state, ...state };\r\n    }\r\n\r\n    get sm() {\r\n        return this.editor.Storage;\r\n    }\r\n\r\n    get cs() {\r\n        return this.editor.Storage.getCurrentStorage();\r\n    }\r\n\r\n    get pm() {\r\n        return this.editor.Pages;\r\n    }\r\n\r\n    onRender() { }\r\n\r\n    handleTabs() { }\r\n}","export function objSizeMegaBytes(obj) {\r\n    return objSizeBytes(obj) / (1024 * 1024);\r\n}\r\n\r\nexport default function objSizeKiloBytes(obj) {\r\n    return objSizeBytes(obj) / 1024;\r\n}\r\n\r\nexport function objSizeBytes(obj) {\r\n    return new TextEncoder().encode(JSON.stringify(obj)).length;\r\n}","// https://github.com/netlify-labs/oauth-example/blob/master/src/utils/sort.js\r\n// License MIT\r\nimport objSize from './objsize';\r\n\r\nexport function matchText(search, text) {\r\n    if (!text || !search) {\r\n        return false\r\n    }\r\n    return text.toLowerCase().indexOf(search.toLowerCase()) > -1\r\n}\r\n\r\nexport function sortByDate(dateType, order) {\r\n    return function (a, b) {\r\n        const timeA = new Date(a[dateType]).getTime()\r\n        const timeB = new Date(b[dateType]).getTime()\r\n        if (order === 'asc') {\r\n            return timeA - timeB\r\n        }\r\n        // default 'desc' descending order\r\n        return timeB - timeA\r\n    }\r\n}\r\n\r\nexport function sortByName(key, order) {\r\n    return function (a, b) {\r\n        if (order === 'asc') {\r\n            if (a[key] < b[key]) return -1\r\n            if (a[key] > b[key]) return 1\r\n        }\r\n        if (a[key] > b[key]) return -1\r\n        if (a[key] < b[key]) return 1\r\n        return 0\r\n    }\r\n}\r\n\r\nexport function sortByPages(key, order) {\r\n    return function (a, b) {\r\n        const pagesA = JSON.parse(a[key]);\r\n        const pagesB = JSON.parse(b[key]);\r\n        if (order === 'desc') {\r\n            if (pagesA.length < pagesB.length) return -1\r\n            if (pagesA.length > pagesB.length) return 1\r\n        }\r\n        if (pagesA.length > pagesB.length) return -1\r\n        if (pagesA.length < pagesB.length) return 1\r\n        return 0\r\n    }\r\n}\r\n\r\nexport function sortBySize(order) {\r\n    return function (a, b) {\r\n        const sizeA = objSize(a);\r\n        const sizeB = objSize(b);\r\n        if (order === 'asc') {\r\n            if (sizeA < sizeB) return -1\r\n            if (sizeA > sizeB) return 1\r\n        }\r\n        if (sizeA > sizeB) return -1\r\n        if (sizeA < sizeB) return 1\r\n        return 0\r\n    }\r\n}","import ago from '../utils/timeago';\r\nimport UI from '../utils/ui';\r\nimport objSize from '../utils/objsize';\r\nimport { sortByDate, sortByName, sortByPages, sortBySize, matchText } from '../utils/sort';\r\n\r\nexport default class TemplateManager extends UI {\r\n    constructor(editor, opts = {}) {\r\n        super(editor, opts);\r\n        this.handleSort = this.handleSort.bind(this);\r\n        this.handleFilterInput = this.handleFilterInput.bind(this);\r\n        this.handleNameInput = this.handleNameInput.bind(this);\r\n        this.handleOpen = this.handleOpen.bind(this);\r\n        this.handleCreate = this.handleCreate.bind(this);\r\n        this.handleDelete = this.handleDelete.bind(this);\r\n        this.openEdit = this.openEdit.bind(this);\r\n\r\n        /* Set initial app state */\r\n        this.state = {\r\n            editableProjectId: '',\r\n            projectId: '',\r\n            tab: 'pages',\r\n            sites: [],\r\n            nameText: '',\r\n            filterText: '',\r\n            loading: false,\r\n            sortBy: 'published_at',\r\n            sortOrder: 'desc'\r\n        };\r\n    }\r\n\r\n    get editableId() {\r\n        return this.state.editableProjectId;\r\n    }\r\n\r\n    get allSites() {\r\n        return this.state.sites;\r\n    }\r\n\r\n    get allSitesSize() {\r\n        return objSize(this.state.sites);\r\n    }\r\n\r\n    onRender() {\r\n        const { setState, cs } = this;\r\n\r\n        /* Set request loading state */\r\n        setState({\r\n            loading: true\r\n        });\r\n\r\n        /* Fetch sites from storage API */\r\n        cs.loadAll(sites => {\r\n            /* Set sites and turn off loading state */\r\n            setState({\r\n                sites,\r\n                loading: false\r\n            });\r\n        },\r\n            err => console.log(\"Error\", err));\r\n    }\r\n\r\n    handleFilterInput(e) {\r\n        this.setState({\r\n            filterText: e.target.value.trim()\r\n        });\r\n    }\r\n\r\n    handleNameInput(e) {\r\n        this.setStateSilent({\r\n            nameText: e.target.value.trim()\r\n        })\r\n    }\r\n\r\n    handleSort(e) {\r\n        const { sortOrder } = this.state;\r\n        if (e.target && e.target.dataset) {\r\n            this.setState({\r\n                sortBy: e.target.dataset.sort,\r\n                // invert sort order\r\n                sortOrder: sortOrder === 'desc' ? 'asc' : 'desc'\r\n            });\r\n        }\r\n    }\r\n\r\n    handleTabs(e) {\r\n        const { target } = e;\r\n        const { $el, pfx, $ } = this;\r\n        $el.find(`.${pfx}tablinks`).removeClass('active');\r\n        $(target).addClass('active');\r\n        if (target.id === 'pages') {\r\n            this.setState({ tab: 'pages' });\r\n        } else {\r\n            this.setState({ tab: 'templates' });\r\n        }\r\n    }\r\n\r\n    handleOpen(e) {\r\n        const { editor, cs } = this;\r\n        const { projectId } = this.state;\r\n        if (!projectId || projectId === cs.currentId) {\r\n            this.opts.currentPageOpen()\r\n            return;\r\n        }\r\n        cs.setId(projectId);\r\n        editor.load(res => {\r\n            cs.setName(res.name);\r\n            cs.setThumbnail(res.thumbnail || '');\r\n            cs.setIsTemplate(res.template);\r\n            cs.setDescription(res.description || 'No description');\r\n            editor.Modal.close();\r\n        });\r\n    }\r\n\r\n    handleCreate(e) {\r\n        const { editor, cs } = this;\r\n        const { projectId, nameText } = this.state;\r\n        const id = editor.runCommand('get-uuidv4');\r\n        const name = nameText || 'New-' + id.substr(0, 8);\r\n        const def = {\r\n            id,\r\n            name,\r\n            template: false,\r\n            thumbnail: '',\r\n            styles: '[]',\r\n            description: 'No description',\r\n        };\r\n        def[`${this.id}pages`] = '[{\"name\": \"index\"}]';\r\n        def[`${this.id}styles`] = '[]';\r\n        def[`${this.id}assets`] = '[]';\r\n        if (!projectId) {\r\n            cs.setId(id);\r\n            cs.store(def, res => {\r\n                cs.setIsTemplate(false);\r\n                editor.load(res => {\r\n                    cs.setId(res.id);\r\n                    cs.setName(res.name);\r\n                    cs.setThumbnail(res.thumbnail || '');\r\n                    cs.setDescription(res.description || 'No description');\r\n                    editor.Modal.close();\r\n                });\r\n            });\r\n        } else {\r\n            cs.setId(projectId);\r\n            cs.setIsTemplate(false);\r\n            editor.load(res => {\r\n                cs.setId(id);\r\n                cs.setName(name);\r\n                cs.setThumbnail(res.thumbnail || '');\r\n                cs.setDescription(res.description || 'No description');\r\n                editor.Modal.close();\r\n            });\r\n        }\r\n    }\r\n\r\n    openEdit(e) {\r\n        const { editor, setStateSilent } = this;\r\n        setStateSilent({\r\n            editableProjectId: e.currentTarget.dataset.id\r\n        });\r\n        editor.Modal.close();\r\n        editor.SettingsApp.setTab('project');\r\n        editor.runCommand('open-settings');\r\n    }\r\n\r\n    handleEdit(data) {\r\n        this.cs.update({ ...data, updated_at: Date() });\r\n    }\r\n\r\n    handleDelete(e) {\r\n        const { cs, setState, opts } = this;\r\n        cs.delete(res => {\r\n            opts.onDelete(res);\r\n            cs.loadAll(sites => setState({ sites }),\r\n                err => console.log(\"Error\", err));\r\n        }, opts.onDeleteError, e.currentTarget.dataset.id);\r\n    }\r\n\r\n    renderSiteList() {\r\n        const { sites, tab, filterText, loading, sortBy, sortOrder } = this.state;\r\n        const { pfx, opts, cs } = this;\r\n\r\n        if (loading) return opts.loader || '<div>Loading sites...</div>';\r\n\r\n        if (!sites.length) return opts.nosites || '<div>No Sites</div>';\r\n\r\n        let order\r\n        if (sortBy === 'id') {\r\n            order = sortByName(sortBy, sortOrder);\r\n        } else if (sortBy === 'updated_at' || sortBy === 'created_at') {\r\n            order = sortByDate(sortBy, sortOrder);\r\n        } else if (sortBy === 'pages') {\r\n            order = sortByPages(this.id + sortBy, sortOrder);\r\n        } else if (sortBy === 'size') {\r\n            order = sortBySize(sortOrder);\r\n        }\r\n\r\n        const sortedSites = sites.sort(order);\r\n\r\n        let matchingSites = sortedSites.filter(site => {\r\n            // No search query. Show all\r\n            if (!filterText && tab === 'pages') {\r\n                return true;\r\n            }\r\n\r\n            const { id, name, template } = site;\r\n            if (\r\n                (matchText(filterText, id) ||\r\n                    matchText(filterText, name)) &&\r\n                tab === 'pages'\r\n            ) {\r\n                return true;\r\n            }\r\n\r\n            if (tab === 'templates' && template) {\r\n                return true;\r\n            }\r\n\r\n            // no match!\r\n            return false;\r\n        })\r\n            .map((site, i) => {\r\n                const {\r\n                    id,\r\n                    name,\r\n                    description,\r\n                    thumbnail,\r\n                    created_at,\r\n                    updated_at\r\n                } = site;\r\n                const size = objSize(site);\r\n                const pages = JSON.parse(site[`${this.id}pages`]);\r\n                const time = updated_at ? ago(new Date(updated_at).getTime()) : 'NA';\r\n                const createdAt = created_at ? ago(new Date(created_at).getTime()) : 'NA';\r\n                const pageNames = pages.map(page => page.name).join(', ');\r\n                return `<div \r\n                    class=\"site-wrapper ${cs.currentId === id ? 'open' : ''}\" \r\n                    key=\"${i}\" \r\n                    data-id=\"${id}\" \r\n                    title=\"${editor.I18n.t('grapesjs-project-manager.templates.titles.open')}\">\r\n                        <div class=\"site-screenshot\">\r\n                            <img src=\"${thumbnail}\" alt=\"\" />\r\n                        </div>\r\n                        <div class=\"site-info\">\r\n                            <h2>\r\n                                ${name}\r\n                            </h2>\r\n                            <div class=\"site-meta\">\r\n                                ${description}\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"site-update-time\">${time}</div>\r\n                        <div class=\"site-pages\">\r\n                            <div title=\"${pageNames || id}\">\r\n                                ${pages.length || 1}\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"site-create-time\">${createdAt}</div>\r\n                        ${opts.size ? `<div class=\"site-size\" title=\"${size} KB\">\r\n                            ${size.toFixed(2)} KB\r\n                        </div>` : ''}\r\n                        <div class=\"site-actions\">\r\n                            <i class=\"${pfx}caret-icon fa fa-hand-pointer-o edit\" title=\"${editor.I18n.t('grapesjs-project-manager.templates.titles.edit')}\" data-id=\"${id}\"></i>\r\n                            ${!(cs.currentId === id) ? `<i class=\"${pfx}caret-icon fa fa-trash-o delete\" title=\"${editor.I18n.t('grapesjs-project-manager.templates.titles.delete')}\" data-id=\"${id}\"></i>` : ''}\r\n                        </div>\r\n                    </div>`;\r\n            }).join('\\n');\r\n\r\n        if (!matchingSites.length) {\r\n            if (tab === 'templates') return opts.nosites || '<div>No Templates Available.</div>';\r\n            matchingSites = `<div>\r\n                    <h3>\r\n                        No '${filterText}' examples found. Clear your search and try again.\r\n                    </h3>\r\n                </div>`;\r\n        }\r\n        return matchingSites;\r\n    }\r\n\r\n    renderSiteActions() {\r\n        return this.state.tab === 'pages' ?\r\n            `<div  class=\"flex-row\">\r\n                <input \r\n                    class=\"search tm-input\" \r\n                    placeholder=\"${editor.I18n.t('grapesjs-project-manager.templates.search')}\"\r\n                />\r\n                <button id=\"open\" class=\"primary-button\">\r\n                    ${editor.I18n.t('grapesjs-project-manager.templates.open')}\r\n                </button>\r\n            </div>` :\r\n            `<div class=\"${this.pfx}tip-about ${this.pfx}four-color\">\r\n                ${editor.I18n.t('grapesjs-project-manager.templates.help')}\r\n            </div>\r\n            <div class=\"flex-row\">\r\n                <input \r\n                    class=\"name tm-input\" \r\n                    placeholder=\"${editor.I18n.t('grapesjs-project-manager.templates.new')}\"\r\n                />\r\n                <button id=\"create\" class=\"primary-button\">\r\n                    ${editor.I18n.t('grapesjs-project-manager.templates.create')}\r\n                </button>\r\n            </div>`;\r\n    }\r\n\r\n    renderThumbnail(thumbnail, page) {\r\n        const def = `<img src=\"${thumbnail}\" alt=\"\" />`;\r\n        if (thumbnail) return def;\r\n        else if (page.html) return `<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"template-preview\" viewBox=\"0 0 1300 1100\" width=\"99%\" height=\"220\">\r\n                <foreignObject width=\"100%\" height=\"100%\" style=\"pointer-events:none\">\r\n                    <div xmlns=\"http://www.w3.org/1999/xhtml\">\r\n                        ${page.html + '<style scoped>' + page.css + '</style>'}\r\n                    </div>\r\n                </foreignObject>\r\n            </svg>`;\r\n        return def;\r\n    }\r\n\r\n    update() {\r\n        this.$el?.find('#site-list').html(this.renderSiteList());\r\n        this.$el?.find('#tm-actions').html(this.renderSiteActions());\r\n        const sites = this.$el?.find('.site-wrapper');\r\n        const search = this.$el?.find('input.search');\r\n        const name = this.$el?.find('input.name');\r\n        this.setStateSilent({ projectId: '' });\r\n        if (sites) {\r\n            sites.on('click', e => {\r\n                sites.removeClass('selected');\r\n                this.$(e.currentTarget).addClass('selected');\r\n                this.setStateSilent({ projectId: e.currentTarget.dataset.id });\r\n            });\r\n        }\r\n        if (search) {\r\n            search.val(this.state.filterText);\r\n            search.on('change', this.handleFilterInput);\r\n        }\r\n        if (name) {\r\n            name.val(this.state.nameText);\r\n            name.on('change', this.handleNameInput);\r\n        }\r\n        this.$el?.find('#open').on('click', this.handleOpen);\r\n        this.$el?.find('#create').on('click', this.handleCreate);\r\n        this.$el?.find('i.edit').on('click', this.openEdit);\r\n        this.$el?.find('i.delete').on('click', this.handleDelete);\r\n    }\r\n\r\n    render() {\r\n        const { $, pfx, opts } = this;\r\n        const { tab } = this.state\r\n\r\n        // Do stuff on render\r\n        this.onRender();\r\n        this.$el?.remove();\r\n\r\n        /* Show admin UI */\r\n        const cont = $(`<div class=\"app\">\r\n                <div class=\"contents\">\r\n                    <div class=\"${pfx}tab\">\r\n                        <button id=\"pages\" class=\"${pfx}tablinks ${tab === 'pages' ? 'active' : ''}\">\r\n                            ${editor.I18n.t('grapesjs-project-manager.templates.all')}\r\n                        </button>\r\n                        <button id=\"templates\" class=\"${pfx}tablinks ${tab === 'templates' ? 'active' : ''}\"\">\r\n                            ${editor.I18n.t('grapesjs-project-manager.templates.templates')}\r\n                        </button>\r\n                    </div>\r\n                    <div id=\"tm-actions\">\r\n                        ${this.renderSiteActions()}\r\n                    </div>\r\n                    <div class=\"site-wrapper-header\">\r\n                        <div\r\n                            class=\"site-screenshot-header header\"\r\n                            data-sort=\"id\"\r\n                            title=\"${editor.I18n.t('grapesjs-project-manager.templates.titles.info')}\"\r\n                        >\r\n                            ${editor.I18n.t('grapesjs-project-manager.templates.info')}\r\n                        </div>\r\n                        <div\r\n                            class=\"site-info header\"\r\n                            data-sort=\"id\"\r\n                        ></div>\r\n                        <div\r\n                            class=\"site-update-time header\"\r\n                            data-sort=\"updated_at\"\r\n                            title=\"${editor.I18n.t('grapesjs-project-manager.templates.titles.updated')}\"\r\n                        >\r\n                            ${editor.I18n.t('grapesjs-project-manager.templates.updated')}\r\n                        </div>\r\n                        <div\r\n                            class=\"site-pages header\"\r\n                            data-sort=\"pages\"\r\n                            title=\"${editor.I18n.t('grapesjs-project-manager.templates.titles.pages')}\"\r\n                        >\r\n                            ${editor.I18n.t('grapesjs-project-manager.templates.pages')}\r\n                        </div>\r\n                        <div\r\n                            class=\"site-create-time header\"\r\n                            data-sort=\"created_at\"\r\n                            title=\"${editor.I18n.t('grapesjs-project-manager.templates.titles.created')}\"\r\n                        >\r\n                            ${editor.I18n.t('grapesjs-project-manager.templates.created')}\r\n                        </div>\r\n                        ${opts.size ? `<div\r\n                            class=\"site-size header\"\r\n                            data-sort=\"size\"\r\n                            title=\"${editor.I18n.t('grapesjs-project-manager.templates.titles.size')}\"\r\n                        >\r\n                            ${editor.I18n.t('grapesjs-project-manager.templates.size')}\r\n                        </div>` : ''}\r\n                        <div\r\n                            class=\"site-actions header\"\r\n                            data-sort=\"id\"\r\n                            title=\"${editor.I18n.t('grapesjs-project-manager.templates.titles.actions')}\"\r\n                        >\r\n                            ${editor.I18n.t('grapesjs-project-manager.templates.actions')}\r\n                        </div>\r\n                    </div>\r\n                    <div id=\"site-list\">\r\n                        ${this.renderSiteList()}\r\n                    </div>\r\n                </div>\r\n            </div>`);\r\n        cont.find('.header').on('click', this.handleSort);\r\n        cont.find('#pages, #templates').on('click', this.handleTabs);\r\n\r\n        this.$el = cont;\r\n        return cont;\r\n    }\r\n}","import UI from '../utils/ui';\r\n\r\nexport default class PagesApp extends UI {\r\n    constructor(editor, opts = {}) {\r\n        super(editor, opts);\r\n        this.addPage = this.addPage.bind(this);\r\n        this.selectPage = this.selectPage.bind(this);\r\n        this.removePage = this.removePage.bind(this);\r\n        this.isSelected = this.isSelected.bind(this);\r\n        this.handleNameInput = this.handleNameInput.bind(this);\r\n        this.openEdit = this.openEdit.bind(this);\r\n\r\n        /* Set initial app state */\r\n        this.state = {\r\n            editablePageId: '',\r\n            isShowing: true,\r\n            nameText: '',\r\n            pages: [],\r\n            loading: false\r\n        };\r\n    }\r\n\r\n    get editableId() {\r\n        return this.state.editablePageId;\r\n    }\r\n\r\n    onRender() {\r\n        const { pm, setState, editor } = this;\r\n        setState({\r\n            loading: true\r\n        });\r\n        setState({\r\n            pages: [...pm.getAll()]\r\n        });\r\n        editor.on('page', () => {\r\n            setState({\r\n                pages: [...pm.getAll()]\r\n            })\r\n        });\r\n        setState({\r\n            loading: false\r\n        });\r\n    }\r\n\r\n    isSelected(page) {\r\n        return this.pm.getSelected().id === page.id;\r\n    }\r\n\r\n    selectPage(e) {\r\n        this.pm.select(e.currentTarget.dataset.key);\r\n        this.update();\r\n    }\r\n\r\n    removePage(e) {\r\n        this.pm.remove(e.currentTarget.dataset.key);\r\n        this.update();\r\n    }\r\n\r\n    openEdit(e) {\r\n        const { editor } = this;\r\n        this.setStateSilent({\r\n            editablePageId: e.currentTarget.dataset.key\r\n        });\r\n        editor.Modal.close();\r\n        editor.SettingsApp.setTab('page');\r\n        editor.runCommand('open-settings');\r\n    }\r\n\r\n    editPage(id, name) {\r\n        const currentPage = this.pm.get(id);\r\n        currentPage?.set('name', name);\r\n        this.update()\r\n    }\r\n\r\n    addPage() {\r\n        const { pm } = this;\r\n        const { nameText } = this.state\r\n        if (!nameText) return;\r\n        pm.add({\r\n            name: nameText,\r\n            component: ''\r\n        });\r\n        this.update();\r\n    }\r\n\r\n    handleNameInput(e) {\r\n        this.setStateSilent({\r\n            nameText: e.target.value.trim()\r\n        })\r\n    }\r\n\r\n    renderPagesList() {\r\n        const { pages, loading } = this.state;\r\n        const { opts, isSelected } = this;\r\n\r\n        if (loading) return opts.loader || '<div>Loading pages...</div>';\r\n\r\n        return pages.map((page, i) => `<div \r\n                data-id=\"${i}\" \r\n                data-key=\"${page.id}\"  \r\n                class=\"page ${isSelected(page) ? 'selected' : ''}\"\r\n            >\r\n                <i class=\"fa fa-file-o\" style=\"margin:5px;\"></i>\r\n                ${page.get('name') || page.id}\r\n                ${isSelected(page) ? '' : `<span class=\"page-close\" data-key=\"${page.id}\">&Cross;</span>`}\r\n                <span class=\"page-edit\" data-key=\"${page.id}\"><i class=\"fa fa-hand-pointer-o\"></i></span>\r\n            </div>`).join(\"\\n\");\r\n    }\r\n\r\n    update() {\r\n        this.$el?.find('.pages').html(this.renderPagesList());\r\n        this.$el?.find('.page').on('click', this.selectPage);\r\n        this.$el?.find('.page-edit').on('click', this.openEdit);\r\n        this.$el?.find('.page-close').on('click', this.removePage);\r\n    }\r\n\r\n    render() {\r\n        const { $, editor } = this;\r\n\r\n        // Do stuff on render\r\n        this.onRender();\r\n        this.$el?.remove();\r\n\r\n        const cont = $(`<div style=\"display: ${this.state.isShowing ? 'flex' : 'none'};\" class=\"pages-wrp\">\r\n                <div class=\"pages\">\r\n                    ${this.renderPagesList()}\r\n                </div>\r\n                <div  class=\"flex-row\">\r\n                    <input \r\n                        class=\"tm-input sm\" \r\n                        type=\"text\" \r\n                        placeholder=\"${editor.I18n.t('grapesjs-project-manager.pages.placeholder')}\" \r\n                    />\r\n                </div>\r\n                <div class=\"add-page\">\r\n                    ${editor.I18n.t('grapesjs-project-manager.pages.new')}\r\n                </div>\r\n            </div>`);\r\n        cont.find('.add-page').on('click', this.addPage);\r\n        cont.find('input').on('change', this.handleNameInput);\r\n\r\n        this.$el = cont;\r\n        return cont;\r\n    }\r\n\r\n    get findPanel() {\r\n        return this.editor.Panels.getPanel('views-container');\r\n    }\r\n\r\n    showPanel() {\r\n        this.state.isShowing = true;\r\n        this.findPanel?.set('appendContent', this.render()).trigger('change:appendContent');\r\n        this.update();\r\n    }\r\n\r\n    hidePanel() {\r\n        this.state.isShowing = false;\r\n        this.render();\r\n    }\r\n}","import UI from '../utils/ui';\r\n\r\nexport default class SettingsApp extends UI {\r\n    constructor(editor, opts = {}) {\r\n        super(editor, opts);\r\n        this.handleSave = this.handleSave.bind(this);\r\n        this.handleThumbnail = this.handleThumbnail.bind(this);\r\n        this.handleThumbnailInput = this.handleThumbnailInput.bind(this);\r\n\r\n        /* Set initial app state */\r\n        this.state = {\r\n            tab: 'page',\r\n            loading: false\r\n        };\r\n    }\r\n\r\n    setTab(tab) {\r\n        this.state.tab = tab;\r\n    }\r\n\r\n    update() {\r\n        const { $el } = this;\r\n        $el?.find('#settings').html(this.renderSettings());\r\n        $el?.find('#generate').on('click', this.handleThumbnail);\r\n        $el?.find('input#thumbnail').on('change', this.handleThumbnailInput);\r\n    }\r\n\r\n    onRender() {\r\n        const { setState } = this;\r\n        setState({\r\n            loading: true\r\n        });\r\n        //? Setup code here \r\n        setState({\r\n            loading: false\r\n        });\r\n    }\r\n\r\n    handleSave(e) {\r\n        const { $el, editor } = this;\r\n        const { tab } = this.state;\r\n        if (tab === 'page') {\r\n            const id = editor.PagesApp.editableId;\r\n            const name = $el?.find('input.name').val().trim();\r\n            id && editor.PagesApp.editPage(id, name);\r\n        } else {\r\n            const id = editor.TemplateManager.editableId;\r\n            const thumbnail = $el?.find('input.thumbnail').val().trim();\r\n            const name = $el?.find('input.name').val().trim();\r\n            const description = $el?.find('input.desc').val().trim();\r\n            const template = $el?.find('input.template').get(0).checked;\r\n            id && editor.TemplateManager.handleEdit({ id, thumbnail, name, description, template });\r\n        }\r\n        editor.Modal.close();\r\n    }\r\n\r\n    handleThumbnail(e) {\r\n        const { editor, $el } = this;\r\n        editor.runCommand('take-screenshot', {\r\n            clb(dataUrl) {\r\n                $el?.find('input.thumbnail').val(dataUrl);\r\n                $el?.find('img').attr('src', dataUrl);\r\n            }\r\n        })\r\n    }\r\n\r\n    handleThumbnailInput(e) {\r\n        this.$el?.find('img').attr('src', e.target.value.trim());\r\n    }\r\n\r\n    renderSettings() {\r\n        const { tab, loading } = this.state;\r\n        const { opts, pfx, pm, editor } = this;\r\n\r\n        if (loading) return opts.loader || '<div>Loading settings...</div>';\r\n\r\n        if (tab === 'page') {\r\n            const page = pm.get(editor.PagesApp.editableId);\r\n            const value = page?.get('name') || page?.id || '';\r\n            return `<label for=\"name\">\r\n                    ${editor.I18n.t('grapesjs-project-manager.settings.labels.name')}\r\n                </label>\r\n                <div class=\"flex-row\">\r\n                    <input \r\n                        class=\"name tm-input\" \r\n                        value=\"${value}\" \r\n                        placeholder=\"${editor.I18n.t('grapesjs-project-manager.settings.placeholders.name')}\"/>\r\n                </div>`\r\n        } else {\r\n            const clb = site => site.id === editor.TemplateManager.editableId;\r\n            const site = editor.TemplateManager.allSites.find(clb);\r\n            return `<div class=\"${pfx}tip-about ${pfx}four-color\">\r\n                    ${editor.I18n.t('grapesjs-project-manager.settings.help')}\r\n                </div>\r\n                <label for=\"thumbnail\">\r\n                    ${editor.I18n.t('grapesjs-project-manager.settings.labels.thumbnail')}\r\n                </label>\r\n                <div class=\"flex-row\">\r\n                    <input \r\n                        id=\"thumbnail\" \r\n                        class=\"thumbnail tm-input\" \r\n                        value=\"${site?.thumbnail || ''}\" \r\n                        placeholder=\"${editor.I18n.t('grapesjs-project-manager.settings.placeholders.thumbnail')}\"\r\n                    />\r\n                </div>\r\n                <div class=\"flex-row\" style=\"margin-bottom:15px;\">\r\n                    <div class=\"site-screenshot\">\r\n                        <img src=\"${site?.thumbnail || ''}\" alt=\"screenshot\" />\r\n                    </div>\r\n                    <button id=\"generate\" class=\"primary-button\">\r\n                        ${editor.I18n.t('grapesjs-project-manager.settings.generate')}\r\n                    </button>\r\n                </div>\r\n                <label for=\"name\">\r\n                    ${editor.I18n.t('grapesjs-project-manager.settings.labels.name')}\r\n                </label>\r\n                <div class=\"flex-row\">\r\n                    <input \r\n                        id=\"name\" \r\n                        class=\"name tm-input\" \r\n                        value=\"${site?.name || ''}\" \r\n                        placeholder=\"${editor.I18n.t('grapesjs-project-manager.settings.placeholders.name')}\"\r\n                    />\r\n                </div>\r\n                <label for=\"desc\">\r\n                    ${editor.I18n.t('grapesjs-project-manager.settings.labels.description')}\r\n                </label>\r\n                <div class=\"flex-row\">\r\n                    <input \r\n                        id=\"desc\" \r\n                        class=\"desc tm-input\" \r\n                        value=\"${site?.description || ''}\" \r\n                        placeholder=\"${editor.I18n.t('grapesjs-project-manager.settings.placeholders.description')}\"\r\n                    />\r\n                </div>\r\n                <div class=\"flex-row group\">\r\n                    <input id=\"template\" class=\"template\" type=\"checkbox\" ${site?.template ? 'checked' : ''}/>\r\n                    <label for=\"template\">\r\n                        ${editor.I18n.t('grapesjs-project-manager.settings.labels.template')}\r\n                    </label>\r\n                </div>`\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const { $ } = this;\r\n\r\n        // Do stuff on render\r\n        this.onRender();\r\n        this.$el?.remove();\r\n\r\n        const cont = $(`<div class=\"app\">\r\n                <div id=\"settings\">\r\n                    ${this.renderSettings()}\r\n                </div>\r\n                <div class=\"flex-row\">\r\n                    <button id=\"save\" class=\"primary-button\">\r\n                        ${editor.I18n.t('grapesjs-project-manager.settings.save')}\r\n                    </button>\r\n                </div>\r\n            </div>`);\r\n        cont.find('#save').on('click', this.handleSave);\r\n        cont.find('#generate').on('click', this.handleThumbnail);\r\n        cont.find('input#thumbnail').on('change', this.handleThumbnailInput);\r\n\r\n        this.$el = cont;\r\n        return cont;\r\n    }\r\n}","import TemplateManager from \"./templates\";\r\nimport PagesApp from \"./pages\";\r\nimport SettingsApp from \"./settings\";\r\n\r\nexport default TemplateManager;\r\nexport { TemplateManager, PagesApp, SettingsApp };","import domtoimage from 'dom-to-image';\r\n\r\nexport default (editor, opts = {}) => {\r\n    const cm = editor.Commands;\r\n    const cs = editor.Storage.getCurrentStorage();\r\n    const mdl = editor.Modal;\r\n    const pfx = editor.getConfig('stylePrefix');\r\n    const mdlClass = `${pfx}mdl-dialog-tml`;\r\n    const mdlClassMd = `${pfx}mdl-dialog-md`;\r\n\r\n    editor.domtoimage = domtoimage;\r\n\r\n    cm.add('open-templates', {\r\n        run(editor, sender) {\r\n            const mdlDialog = document.querySelector(`.${pfx}mdl-dialog`);\r\n            mdlDialog.classList.add(mdlClass);\r\n            sender?.set && sender.set('active');\r\n            mdl.setTitle(opts.mdlTitle);\r\n            mdl.setContent(editor.TemplateManager.render());\r\n            mdl.open();\r\n            mdl.getModel().once('change:open', () => {\r\n                mdlDialog.classList.remove(mdlClass);\r\n            });\r\n        }\r\n    });\r\n\r\n    cm.add('open-settings', {\r\n        run(editor, sender) {\r\n            const mdlDialog = document.querySelector(`.${pfx}mdl-dialog`);\r\n            mdlDialog.classList.add(mdlClassMd);\r\n            sender?.set && sender.set('active');\r\n            mdl.setTitle(opts.mdlTitle);\r\n            mdl.setContent(editor.SettingsApp.render());\r\n            mdl.open();\r\n            mdl.getModel().once('change:open', () => {\r\n                mdlDialog.classList.remove(mdlClassMd);\r\n            });\r\n        }\r\n    });\r\n\r\n    cm.add('open-pages', {\r\n        run(editor) {\r\n            editor.PagesApp.showPanel();\r\n        },\r\n        stop(editor) {\r\n            editor.PagesApp.hidePanel();\r\n        }\r\n    })\r\n\r\n    //some magic from gist.github.com/jed/982883\r\n    const uuidv4 = () => ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, c =>\r\n        (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)\r\n    );\r\n\r\n    const getJpeg = (node, opts = {}, clb, clbErr) => {\r\n        domtoimage.toJpeg(node, opts)\r\n            .then(dataUrl => clb && clb(dataUrl))\r\n            .catch(err => clbErr && clbErr(err))\r\n    };\r\n\r\n    cm.add('get-uuidv4', () => uuidv4());\r\n\r\n    cm.add('take-screenshot', (editor, s, options = { clb(d) { return d } }) => {\r\n        const el = editor.getWrapper().getEl();\r\n        getJpeg(el, {\r\n            quality: opts.quality,\r\n            height: 1000,\r\n            'cacheBust': true,\r\n            style: {\r\n                'background-color': 'white',\r\n                ...editor.getWrapper().getStyle()\r\n            },\r\n        }, options.clb, opts.onScreenshotError);\r\n    });\r\n\r\n    cm.add('save-as-template', editor => {\r\n        cs.setIsTemplate(true);\r\n        editor.store();\r\n    });\r\n\r\n    cm.add('delete-template', editor => {\r\n        cs.delete(opts.onDelete, opts.onDeleteError);\r\n    });\r\n}","export const storageIDB = 'indexeddb',\r\n    storageRemote = 'rest-api',\r\n    storageFireStore = 'firestore';","import { storageIDB } from '../consts';\r\n\r\nexport default (editor, opts = {}) => {\r\n    let db;\r\n    const sm = editor.StorageManager;\r\n    const storageName = storageIDB;\r\n    const objsName = opts.objectStoreName;\r\n\r\n    // Functions for DB retrieving\r\n    const getDb = () => db;\r\n    const getAsyncDb = (clb) => {\r\n        if (db) {\r\n            clb(db);\r\n        } else {\r\n            const indexedDB = window.indexedDB || window.mozIndexedDB ||\r\n                window.webkitIndexedDB || window.msIndexedDB;\r\n            const request = indexedDB.open(opts.dbName, opts.indexeddbVersion);\r\n            const onError = () => sm.onError(storageName, request.errorCode);\r\n            request.onerror = onError;\r\n            request.onsuccess = () => {\r\n                db = request.result;\r\n                db.onerror = onError;\r\n                clb(db);\r\n            };\r\n            request.onupgradeneeded = e => {\r\n                const objs = e.currentTarget.result.createObjectStore(objsName, { keyPath: 'id' });\r\n                objs.createIndex('name', 'name', { unique: false });\r\n            };\r\n        }\r\n    };\r\n\r\n    // Functions for object store retrieving\r\n    const getObjectStore = () => {\r\n        return db.transaction([objsName], 'readwrite').objectStore(objsName);\r\n    };\r\n    const getAsyncObjectStore = clb => {\r\n        if (db) {\r\n            clb(getObjectStore());\r\n        } else {\r\n            getAsyncDb(db => clb(getObjectStore()))\r\n        }\r\n    };\r\n\r\n    // Add custom storage to the editor\r\n    sm.add(storageName, {\r\n        currentName: 'Default',\r\n        currentId: 'uuidv4',\r\n        currentThumbnail: '',\r\n        isTemplate: false,\r\n        description: 'No description',\r\n        getDb,\r\n\r\n        getObjectStore,\r\n\r\n        setId(id) {\r\n            this.currentId = id;\r\n        },\r\n\r\n        setName(name) {\r\n            this.currentName = name;\r\n        },\r\n\r\n        setThumbnail(thumbnail) {\r\n            this.currentThumbnail = thumbnail;\r\n        },\r\n\r\n        setIsTemplate(isTemplate) {\r\n            this.isTemplate = !!isTemplate;\r\n        },\r\n\r\n        setDescription(description) {\r\n            this.description = description;\r\n        },\r\n\r\n        load(keys, clb, clbErr) {\r\n            getAsyncObjectStore(objs => {\r\n                const request = objs.get(this.currentId);\r\n                request.onerror = clbErr;\r\n                request.onsuccess = () => {\r\n                    clb && clb(request.result);\r\n                };\r\n            });\r\n        },\r\n\r\n        loadAll(clb, clbErr) {\r\n            getAsyncObjectStore(objs => {\r\n                const request = objs.getAll();\r\n                request.onerror = clbErr;\r\n                request.onsuccess = () => {\r\n                    clb && clb(request.result);\r\n                };\r\n            });\r\n        },\r\n\r\n        store(data, clb, clbErr) {\r\n            getAsyncObjectStore(objs => {\r\n                const request = objs.put({\r\n                    id: this.currentId,\r\n                    name: this.currentName,\r\n                    template: this.isTemplate,\r\n                    thumbnail: this.currentThumbnail,\r\n                    description: this.description,\r\n                    updated_at: Date(),\r\n                    ...data\r\n                });\r\n                request.onerror = clbErr;\r\n                request.onsuccess = clb;\r\n            });\r\n        },\r\n\r\n        update(data, clb, clbErr) {\r\n            const { id, ..._data } = data;\r\n            getAsyncObjectStore(objs => {\r\n                const request = objs.get(id);\r\n                request.onerror = clbErr;\r\n                request.onsuccess = () => {\r\n                    objs.put({ id, ...request.result, ..._data });\r\n                    clb && clb(request.result);\r\n                };\r\n            });\r\n        },\r\n\r\n        delete(clb, clbErr, index) {\r\n            getAsyncObjectStore(objs => {\r\n                const request = objs.delete(index || this.currentId);\r\n                request.onerror = clbErr;\r\n                request.onsuccess = clb;\r\n            });\r\n        }\r\n    });\r\n}","import { storageRemote } from '../consts';\r\n\r\nexport default (editor, opts = {}) => {\r\n    const sm = editor.StorageManager;\r\n    const storageName = storageRemote;\r\n    const remote = sm.get('remote');\r\n\r\n    // Add custom storage to the editor\r\n    sm.add(storageName, {\r\n        currentName: 'Default',\r\n        currentId: 'uuidv4',\r\n        currentThumbnail: '',\r\n        isTemplate: false,\r\n        description: 'No description',\r\n\r\n        setId(id) {\r\n            this.currentId = id;\r\n        },\r\n\r\n        setName(name) {\r\n            this.currentName = name;\r\n        },\r\n\r\n        setThumbnail(thumbnail) {\r\n            this.currentThumbnail = thumbnail;\r\n        },\r\n\r\n        setIsTemplate(isTemplate) {\r\n            this.isTemplate = !!isTemplate;\r\n        },\r\n\r\n        setDescription(description) {\r\n            this.description = description;\r\n        },\r\n\r\n        load(keys, clb, clbErr) {\r\n            const urlLoad = remote.get('urlLoad');\r\n            const id = urlLoad.endsWith('/') ? this.currentId : `/${this.currentId}`;\r\n            remote.set({ urlLoad: urlLoad + id });\r\n            remote.load(keys, clb, clbErr);\r\n            remote.set({ urlLoad });\r\n        },\r\n\r\n        loadAll(clb, clbErr) {\r\n            remote.load({}, clb, clbErr);\r\n        },\r\n\r\n        store(data, clb, clbErr) {\r\n            const urlStore = remote.get('urlStore');\r\n            const id = urlStore.endsWith('/') ? this.currentId : `/${this.currentId}`;\r\n            opts.uuidInPath && remote.set({ urlStore: urlStore + id });\r\n            remote.store({\r\n                id: this.currentId,\r\n                name: this.currentName,\r\n                template: this.isTemplate,\r\n                thumbnail: this.currentThumbnail,\r\n                description: this.description,\r\n                updated_at: Date(),\r\n                ...data\r\n            }, clb, clbErr);\r\n            remote.set({ urlStore });\r\n        },\r\n\r\n        update(data, clb, clbErr) {\r\n            const urlLoad = remote.get('urlLoad');\r\n            let { id } = data;\r\n            id = urlLoad.endsWith('/') ? id : `/${id}`;\r\n            remote.set({ urlLoad: urlLoad + id });\r\n            remote.load({}, res => {\r\n                const body = { ...res, ...data };\r\n                const method = 'post';\r\n                const urlUpdate = remote.get('urlStore');\r\n                id = data.id;\r\n                id = urlUpdate.endsWith('/') ? id : `/${id}`;\r\n                remote.request(urlUpdate + id, { method, body }, clb, clbErr);\r\n            }, clbErr);\r\n            remote.set({ urlLoad });\r\n        },\r\n\r\n        delete(clb, clbErr, index) {\r\n            const urlDelete = remote.get('urlDelete');\r\n            let id = index || this.currentId;\r\n            id = urlDelete.endsWith('/') ? id : `/${id}`;\r\n            remote.request(urlDelete + id, { method: 'delete' }, clb, clbErr);\r\n        }\r\n    });\r\n}","import { storageFireStore } from '../consts';\r\n\r\nexport default (editor, opts = {}) => {\r\n    const sm = editor.StorageManager;\r\n    const storageName = storageFireStore;\r\n\r\n    let db;\r\n    let doc;\r\n    let collection;\r\n    const { apiKey, authDomain, projectId } = opts;\r\n    const dbSettings = opts.settings;\r\n    const onError = err => sm.onError(storageName, err.code || err);\r\n\r\n    const getDoc = () => doc;\r\n\r\n    const getAsyncCollection = (clb) => {\r\n        if (collection) return clb(collection);\r\n        if (!firebase.apps.length) {\r\n            firebase.initializeApp({ apiKey, authDomain, projectId, ...opts.firebaseConfig });\r\n            db = firebase.firestore();\r\n            db.settings(dbSettings);\r\n        }\r\n        else {\r\n            firebase.app();\r\n            db = firebase.firestore();\r\n            db.settings(dbSettings);\r\n        }\r\n\r\n        const callback = () => {\r\n            collection = db.collection(opts.objectStoreName);\r\n            clb(collection);\r\n        }\r\n\r\n        callback();\r\n\r\n        //if (opts.enableOffline) {\r\n        //    db.enablePersistence().then(callback).catch(onError);\r\n        //} else {\r\n        //    callback();\r\n        //}\r\n    };\r\n\r\n    const getAsyncDoc = (clb) => {\r\n        getAsyncCollection(cll => {\r\n            const cs = editor.Storage.getCurrentStorage();\r\n            doc = cll.doc(cs.currentId);\r\n            clb(doc);\r\n        });\r\n    };\r\n\r\n    sm.add(storageName, {\r\n        currentName: 'Default',\r\n        currentId: 'uuidv4',\r\n        currentThumbnail: '',\r\n        isTemplate: false,\r\n        description: 'No description',\r\n        getDoc,\r\n\r\n        setDocId(id) {\r\n            this.currentId = id;\r\n        },\r\n\r\n        setId(id) {\r\n            this.currentId = id;\r\n        },\r\n\r\n        setName(name) {\r\n            this.currentName = name;\r\n        },\r\n\r\n        setThumbnail(thumbnail) {\r\n            this.currentThumbnail = thumbnail;\r\n        },\r\n\r\n        setIsTemplate(isTemplate) {\r\n            this.isTemplate = !!isTemplate;\r\n        },\r\n\r\n        setDescription(description) {\r\n            this.description = description;\r\n        },\r\n\r\n        load(keys, clb, clbError) {\r\n            getAsyncDoc(doc => {\r\n                doc.get()\r\n                    .then(doc => {\r\n                        if (doc.exists) clb(doc.data());\r\n                        else clb({});\r\n                    })\r\n                    .catch(clbError);\r\n            });\r\n        },\r\n\r\n        loadAll(clb, clbError) {\r\n            getAsyncCollection(cll => {\r\n                cll.get()\r\n                    .then(docs => {\r\n                        const data = [];\r\n                        docs.forEach(doc => data.push(doc.data()));\r\n                        clb(data);\r\n                    })\r\n                    .catch(clbError);\r\n            });\r\n        },\r\n\r\n        store(data, clb, clbError) {\r\n            getAsyncCollection(cll => {\r\n                cll.doc(data.id || this.currentId).set({\r\n                    id: this.currentId,\r\n                    name: this.currentName,\r\n                    template: this.isTemplate,\r\n                    thumbnail: this.currentThumbnail,\r\n                    description: this.description,\r\n                    updated_at: Date(),\r\n                    ...data\r\n                })\r\n                    .then(clb)\r\n                    .catch(clbError);\r\n            });\r\n        },\r\n\r\n        update(data, clb, clbError) {\r\n            const { id, ..._data } = data;\r\n            getAsyncCollection(cll => {\r\n                cll.doc(id).set(_data, { merge: true })\r\n                    .then(clb)\r\n                    .catch(clbError);\r\n            });\r\n        },\r\n\r\n        delete(clb, clbError, index) {\r\n            if (!index) {\r\n                getAsyncDoc(doc => {\r\n                    doc.delete()\r\n                        .then(clb)\r\n                        .catch(clbError);\r\n                });\r\n            } else {\r\n                getAsyncCollection(cll => {\r\n                    cll.doc(index).delete()\r\n                        .then(clb)\r\n                        .catch(clbError);\r\n                });\r\n            }\r\n        }\r\n    });\r\n}","import indexeddb from './indexeddb';\r\nimport remote from './remote';\r\nimport firestore from './firestore';\r\n\r\nexport default (editor, opts = {}) => {\r\n    // Load indexeddb storage\r\n    indexeddb(editor, opts);\r\n\r\n    // Load remote storage\r\n    remote(editor, opts);\r\n\r\n    // Load firestore storage\r\n    firestore(editor, opts);\r\n}","export default {\r\n    'grapesjs-project-manager': {\r\n        templates: {\r\n            all: 'All',\r\n            templates: 'Templates',\r\n            search: 'Search for sites by name or id',\r\n            open: 'Open',\r\n            new: 'Enter new page name',\r\n            create: 'Create',\r\n            help: 'Select a template, enter project name, then click create. If no template is selected a blank project will be created.',\r\n            info: 'Site Info',\r\n            updated: 'Last Updated',\r\n            pages: 'Pages',\r\n            created: 'Created At',\r\n            size: 'Size',\r\n            actions: 'Actions',\r\n            titles: {\r\n                open: 'Select to open site',\r\n                info: 'Click to sort by site name',\r\n                updated: 'Click to sort by last update date',\r\n                pages: 'Click to sort by number of pages',\r\n                created: 'Click to sort by site creation date',\r\n                size: 'Click to sort by site size',\r\n                actions: 'Click to sort by site name',\r\n                delete: 'Delete',\r\n                edit: 'Edit',\r\n            }\r\n        },\r\n        pages: {\r\n            placeholder: 'page name',\r\n            new: 'New Page +',\r\n        },\r\n        settings: {\r\n            save: 'Save',\r\n            generate: 'Generate',\r\n            help: 'Enter url, or generate thumbnail.',\r\n            labels: {\r\n                name: 'Name',\r\n                thumbnail: 'Thumbnail',\r\n                description: 'Description',\r\n                template: 'Template'\r\n            },\r\n            placeholders: {\r\n                name: 'Name...',\r\n                thumbnail: 'Thumbnail...',\r\n                description: 'Description...',\r\n            },\r\n        },\r\n    }\r\n}","import TemplateManager, { PagesApp, SettingsApp } from './manager';\r\nimport commands from './commands';\r\nimport storage from './storage';\r\nimport en from './locale/en';\r\n\r\nexport default (editor, opts = {}) => {\r\n    const options = {\r\n        ...{\r\n            // default options\r\n            // Database name\r\n            dbName: 'gjs',\r\n\r\n            // Collection name\r\n            objectStoreName: 'projects',\r\n\r\n            // Load first template in storage\r\n            loadFirst: true,\r\n\r\n            // Add uuid as path parameter to store path for rest-api\r\n            uuidInPath: true,\r\n\r\n            // Indexeddb version schema\r\n            indexeddbVersion: 5,\r\n\r\n            // When template or page is deleted\r\n            onDelete(res) {\r\n                console.log('Deleted:', res)\r\n            },\r\n\r\n            // When error onDelete\r\n            onDeleteError(err) {\r\n                console.log(err)\r\n            },\r\n\r\n            // On screenshot error\r\n            onScreenshotError(err) {\r\n                console.log(err)\r\n            },\r\n\r\n            // Quality of screenshot image from 0 to 1, more quality increases the image size\r\n            quality: .01,\r\n\r\n            // Content for templates modal title\r\n            mdlTitle: 'Project Manager',\r\n\r\n            // Show when no pages yet pages\r\n            nopages: '<div style=\"display:flex;align-items:center;padding:50px;margin:auto;\">No Projects Yet</div>',\r\n\r\n            // Firebase API key\r\n            apiKey: '',\r\n\r\n            // Firebase Auth domain\r\n            authDomain: '',\r\n\r\n            // Cloud Firestore project ID\r\n            projectId: '',\r\n\r\n            // Enable support for offline data persistence\r\n            enableOffline: true,\r\n\r\n            // Firebase app config\r\n            firebaseConfig: {},\r\n\r\n            // Database settings (https://firebase.google.com/docs/reference/js/firebase.firestore.Settings)\r\n            settings: { timestampsInSnapshots: true },\r\n\r\n            // Show estimated project statistics\r\n            size: false,\r\n\r\n            // Send feedback when open is clicked on current page\r\n            currentPageOpen() {\r\n                console.log('Current page already open')\r\n            },\r\n\r\n            i18n: {},\r\n        },\r\n        ...opts,\r\n    };\r\n\r\n    editor.I18n.addMessages({\r\n        en,\r\n        ...options.i18n,\r\n    });\r\n\r\n    // Init and add dashboard object to editor\r\n    editor.TemplateManager = new TemplateManager(editor, options);\r\n    editor.PagesApp = new PagesApp(editor, options);\r\n    editor.SettingsApp = new SettingsApp(editor, options);\r\n\r\n    // Load commands\r\n    commands(editor, options);\r\n\r\n    // Load storages\r\n    storage(editor, options);\r\n\r\n    // Load page with index zero\r\n    editor.on('load', () => {\r\n        const cs = editor.Storage.getCurrentStorage();\r\n        cs.loadAll(res => {\r\n            const firstPage = res[0];\r\n            if (firstPage && options.loadFirst) {\r\n                cs.setId(firstPage.id);\r\n                cs.setName(firstPage.name);\r\n                cs.setThumbnail(firstPage.thumbnail);\r\n                cs.setIsTemplate(firstPage.template);\r\n                editor.load();\r\n            } else {\r\n                cs.setId(editor.runCommand('get-uuidv4'));\r\n                cs.setName(`Default-${cs.currentId.substr(0, 7)}`);\r\n                options.components && editor.setComponents(options.components);\r\n                options.style && editor.setStyle(options.style);\r\n            }\r\n        });\r\n    });\r\n};"],"sourceRoot":""}