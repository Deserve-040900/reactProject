function eXcell_sub_row(cell){if(cell){this.cell=cell;this.grid=this.cell.parentNode.grid;};this.getValue=function(){return this.grid.getUserData(this.cell.parentNode.idd,"__sub_row");};this.yB=function(m,v){(v||this.cell).innerHTML="<img src='"+this.grid.eg+m+"' width='18' height='18' />";(v||this.cell).firstChild.onclick=this.grid.wJ;};this.open=function(){this.cell.firstChild.onclick(null,true)};this.close=function(){this.cell.firstChild.onclick(null,false,true)};this.setValue=function(val){if(val)this.grid.setUserData(this.cell.parentNode.idd,"__sub_row",val);this.yB(val?"plus.gif":"blanc.gif");};this.setContent=function(val){if(this.cell.parentNode.wE){this.cell.parentNode.wE.innerHTML=val;this.grid.TX(this.cell.parentNode.wE,this.cell,this.cell.parentNode.wE.scrollHeight)}else{this.cell.Vy=null;this.setValue(val);this.cell.SH=null}};this.isDisabled=function(){return true;};this.getTitle=function(){return this.grid.getUserData(this.cell.parentNode.idd,"__sub_row")?"click to expand|collapse":"";}};eXcell_sub_row.prototype=new gD;function eXcell_sub_row_ajax(cell){this.base=eXcell_sub_row;this.base(cell);this.setValue=function(val){if(val)this.grid.setUserData(this.cell.parentNode.idd,"__sub_row",val);this.cell.SH="ajax";this.yB(val?"plus.gif":"blanc.gif");}};eXcell_sub_row_ajax.prototype=new eXcell_sub_row;function eXcell_sub_row_grid(cell){this.base=eXcell_sub_row;this.base(cell);this.setValue=function(val){if(val)this.grid.setUserData(this.cell.parentNode.idd,"__sub_row",val);this.cell.SH="grid";this.yB(val?"plus.gif":"blanc.gif");};this.aec=function(){if(!cell.RF)return null;return cell.RF;}};eXcell_sub_row_grid.prototype=new eXcell_sub_row;dhtmlXGridObject.prototype.wJ=function(n,show,hide){var td=this.parentNode;var row=td.parentNode;var that=row.grid;var c=that.getUserData(row.idd,"__sub_row");if(!that.gC)that.gC=new eXcell_sub_row(td);if(!c)return;if(row.wE&& !show){that.gC.yB("plus.gif",td);td.Vy=row.wE;that.HF.removeChild(row.wE);row.wE=false;row.style.height=(row.oldHeight||20)+"px";td.style.height=(row.oldHeight||20)+"px";if(that.aC)that.aC.bj[row.idd].style.height=(row.oldHeight||20)+"px";for(var i=0;i<row.cells.length;i++){row.cells[i].style.verticalAlign="middle";row.cells[i].style.paddingTop="0px";};delete that.qz[row.idd];that.qR();row.wE.ctrl=null;}else if(!row.wE&& !hide){that.gC.yB("minus.gif",td);row.oldHeight=td.offsetHeight;if(td.Vy){var d=td.Vy;d.ctrl=td;that.HF.appendChild(d);that.TX(d,td,parseInt(d.style.height))}else{var d=document.createElement("DIV");d.ctrl=td;if(td.SH)that.YO[td.SH](that,d,td,c);else d.innerHTML=c;d.style.cssText="position:absolute;left:0px;top:0px;overflow:auto;font-family:Tahoma;font-size:8pt;margin-top:2px;margin-left:4px;";d.className="dhx_sub_row";that.HF.appendChild(d);that.TX(d,td)};if(!that.qz){that.attachEvent("onGridReconstructed",function(){if(this.aW||this.ahK)this._collapsMonolite();else this.qR();});that.attachEvent("onResizeEnd",function(){this.qR(true);});that.attachEvent("onAfterCMove",function(){this.qR(true);});that.attachEvent("onDrop",function(){this.qR(true);});that.attachEvent("onBeforePageChanged",function(){this._collapsMonolite();return true;});that.attachEvent("onGroupStateChanged",function(){this.qR();return true;});that.attachEvent("onFilterEnd",function(){this._collapsMonolite();});that.attachEvent("onUnGroup",function(){this._collapsMonolite();});that.attachEvent("onPageChanged",function(){this._collapsMonolite();});that.attachEvent("onXLE",function(){this._collapsMonolite();});that.attachEvent("onClearAll",function(){for(var i in this.qz){if(this.qz[i]&&this.qz[i].parentNode)this.qz[i].parentNode.removeChild(this.qz[i]);};this.qz=[];});that.attachEvent("onEditCell",function(a,b,c){if((a!==2)&&this.qz[b]&&this.cellType[c]!="ch"&&this.cellType[c]!="ra")this.wJ.apply(this.qz[b].ctrl.firstChild,[0,false,true]);return true;});that.attachEvent("onCellChanged",function(id,ind){if(!this.qz[id])return;var c=this.cells(id,ind).cell;c.style.verticalAlign="top";c.style.paddingTop="3px";});that.qz=[];};that.qz[row.idd]=d;that.qR();for(var i=0;i<row.cells.length;i++){row.cells[i].style.verticalAlign="top";row.cells[i].style.paddingTop="3px";};if(that.aC){var frow=that.aC.bj[row.idd];for(var i=0;i<frow.cells.length;i++){frow.cells[i].style.verticalAlign="top";frow.cells[i].style.paddingTop="3px";}};td.style.paddingTop="1px";row.wE=d;};if(that.abK)that.setSizes();if(that.parentGrid)that.callEvent("onGridReconstructed",[]);that.callEvent("onSubRowOpen",[row.idd,(! !row.wE)]);};dhtmlXGridObject.prototype.YO={"ajax":function(that,d,td,c){d.innerHTML="Loading...";var xml=new ag(function(){d.innerHTML=xml.ai.responseText;var z=xml.ai.responseText.match(/<script[^>]*>([^<]+)<\/script>/g);if(z)for(var i=0;i<z.length;i++)eval(z[i].replace(/<([\/]{0,1})s[^>]*>/g,""));that.TX(d,td);that.qR();that.setUserData(td.parentNode.idd,"__sub_row",xml.ai.responseText);td.SH=null;if(that.abK)that.setSizes();that.callEvent("onSubAjaxLoad",[td.parentNode.idd,xml.ai.responseText]);},this,true,true);xml.loadXML(c);},"grid":function(that,d,td,c){td.RF=new dhtmlXGridObject(d);if(that.skin_name)td.RF.setSkin(that.skin_name);td.RF.parentGrid=that;td.RF.setImagePath(that.eg);td.RF.enableAutoHeight(true);td.RF.attachEvent("onGridReconstructed",function(){that.TX(d,td,td.RF.HF.scrollHeight+td.RF.hdr.offsetHeight+(this.ftr?this.ftr.offsetHeight:0));that.qR();this.setSizes();if(that.parentGrid)that.callEvent("onGridReconstructed",[]);});if(!that.callEvent("onSubGridCreated",[td.RF,td.parentNode.idd,td._cellIndex,c]))return;td.RF.loadXML(c,function(){that.TX(d,td,td.RF.HF.scrollHeight+td.RF.hdr.offsetHeight+(td.RF.ftr?td.RF.ftr.offsetHeight:0));td.RF.HF.style.overflow="hidden";that.qR();td.SH=null;if(!that.callEvent("onSubGridLoaded",[td.RF,td.parentNode.idd,td._cellIndex,c]))return;if(that.abK)that.setSizes();});}};dhtmlXGridObject.prototype.TX=function(d,td,h){var l=td.offsetLeft+td.offsetWidth;d.style.left=l+"px";d.style.width=Math.max(0,td.parentNode.offsetWidth-l-4)+"px";var h=h||d.scrollHeight;d.style.overflow="hidden";d.style.height=h+"px";var row=td.parentNode;td.parentNode.style.height=(row.oldHeight||20)+3+h*1+"px";td.style.height=(row.oldHeight||20)+3+h*1+"px";if(this.aC){var tr=this.aC.bj[td.parentNode.idd];tr.style.height=(row.oldHeight||20)+3+h*1+"px";}};dhtmlXGridObject.prototype.qR=function(mode){if(this._in_correction)return;this._in_correction=true;for(var a in this.qz)if(this.qz[a]&&this.qz[a].tagName=="DIV")if(this.bj[a]){if(this.bj[a].style.display=="none"){this.cells4(this.qz[a].ctrl).close();continue;};this.qz[a].style.top=this.bj[a].offsetTop+(this.bj[a].oldHeight||20)+"px";if(mode){var l=this.qz[a].ctrl.offsetLeft+this.qz[a].ctrl.offsetWidth;this.qz[a].style.left=l+"px";this.qz[a].style.width=this.bj[a].offsetWidth-l-4+"px"}}else{this.qz[a].ctrl=null;this.HF.removeChild(this.qz[a]);delete this.qz[a];};this._in_correction=false;};dhtmlXGridObject.prototype._collapsMonolite=function(){for(var a in this.qz)if(this.qz[a]&&this.qz[a].tagName=="DIV")if(this.bj[a])this.cells4(this.qz[a].ctrl).close();};