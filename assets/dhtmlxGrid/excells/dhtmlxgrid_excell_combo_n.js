dhtmlXGridObject.prototype._init_point_bcg=dhtmlXGridObject.prototype.Yz;dhtmlXGridObject.prototype.Yz=function(){if(!window.fe)window.fe=this.eg;this._col_combos=[];for(var b=0;b<this.gA;b++)this.cellType[b].indexOf("combo")==0&&(this._col_combos[b]=eXcell_combo.prototype.initCombo.call({grid:this},b));if(!this._loading_handler_set)this._loading_handler_set=this.attachEvent("onXLE",function(a,b,e,c){eXcell_combo.prototype.fillColumnCombos(this,c);this.detachEvent(this._loading_handler_set);this._loading_handler_set=null});this._init_point_bcg&&this._init_point_bcg()};function eXcell_combo(b){if(b)this.cell=b,this.grid=b.parentNode.grid,this._combo_pre="",this.edit=function(){if(!window.fe)window.fe=this.grid.eg;this.val=this.getValue();var a=this.getText();this.cell.mG&&(a="");this.cell.innerHTML="";this.combo=this.cell._brval?this.cell._brval:(this.grid.nh?this.grid.aC:this.grid)._col_combos[this.cell._cellIndex];this.cell.appendChild(this.combo.zZ);this.combo.zZ.style.margin="0";this.combo.fK.focus();this.combo.Gl(this.cell.offsetWidth-2);this.combo.cG?this.combo.nQ(a):this.combo.gg(this.cell.combo_value)!= -1?this.combo.dn(this.combo.gg(this.cell.combo_value)):this.combo.MV(a)?this.combo.dn(this.combo.gg(this.combo.MV(a).value)):this.combo.nQ(a);this.combo.BJ()},this.selectComboOption=function(a,b){b.dn(b.gg(b.MV(a).value))},this.getValue=function(){return this.cell.combo_value},this.getText=function(){var a=this.cell;this._combo_pre==""&&a.childNodes[1]&&(a=a.childNodes[1]);return _isIE?a.innerText:a.textContent},this.setValue=function(a){if(typeof a=="object"){this.cell._brval=this.initCombo();var b=this.cell._cellIndex,e=this.cell.parentNode.idd;a.firstChild?this.cell.combo_value=a.firstChild.data:(this.cell.combo_value="&nbsp;",this.cell.mG= !0);this.setComboOptions(this.cell._brval,a,this.grid,b,e)}else{this.cell.combo_value=a;var c=null;if((c=this.cell._brval)&&typeof this.cell._brval=="object")a=(c.acS(a)||{}).text||a;else if(c=this.grid._col_combos[this.cell._cellIndex]||this.grid.aC&&(c=this.grid.aC._col_combos[this.cell._cellIndex]))a=(c.acS(a)||{}).text||a;if((a||"").toString().PA()=="")a=null;a!==null?this.setComboCValue(a):(this.setComboCValue("&nbsp;",""),this.cell.mG= !0)}},this.detach=function(){this.cell.removeChild(this.combo.zZ);var a=this.cell.combo_value;!this.combo.nK()||this.combo.nK().toString().PA()==""?(this.setComboCValue("&nbsp;"),this.cell.mG= !0):(this.setComboCValue(this.combo.nK(),this.combo.FV()),this.cell.mG= !1);this.combo.Sn();this.cell.combo_value=this.combo.FV();this.combo.aw();this.grid.QX= !0;this.grid.setActive(1);return a!=this.cell.combo_value}}eXcell_combo.prototype=new gD;eXcell_combo_v=function(b){var a=new eXcell_combo(b);b.style.paddingLeft="0px";b.style.paddingRight="0px";a._combo_pre="<img src='"+(window.fe?window.fe:this.grid.eg)+"combo_select"+(dhtmlx.skin?"_"+dhtmlx.skin:"")+".gif' style='position:absolute;z-index:1;top:0px;right:0px;'/>";return a};eXcell_combo.prototype.initCombo=function(b){var a=document.createElement("DIV"),d=this.grid.QL[arguments.length?b:this.cell._cellIndex],e=new dhtmlXCombo(a,"combo",0,d);this.grid.QL[arguments.length?b:this.cell._cellIndex]="";e.fR.className+=" fake_editable";var c=this.grid;e.fR.onselectstart=function(){return event.cancelBubble= !0};e.attachEvent("onKeyPressed",function(a){if(a==13||a==27)c.editStop(),c.aC&&c.aC.editStop()});dhtmlxEvent(e.dr,"click",function(){c.editStop();c.aC&&c.aC.editStop()});e.fR.style.border="0px";e.fR.style.height="18px";return e};eXcell_combo.prototype.fillColumnCombos=function(b,a){if(a){b.combo_columns=b.combo_columns||[];columns=b.bA.et("//column",a);for(var d=0;d<columns.length;d++)if((columns[d].getAttribute("type")||"").indexOf("combo")==0)b.combo_columns[b.combo_columns.length]=d,this.setComboOptions(b._col_combos[d],columns[d],b,d)}};eXcell_combo.prototype.setComboCValue=function(b,a){this._combo_pre!=""&&(b="<div style='width:100%;position:relative;height:100%;overflow:hidden;line-height:20px'>"+this._combo_pre+"<span>"+b+"</span></div>");arguments.length>1?this.dq(b,a):this.dq(b)};eXcell_combo.prototype.setComboOptions=function(b,a,d,e,c){if(ap(a.getAttribute("xmlcontent"))&& !a.getAttribute("source")){options=a.childNodes;for(var h=[],g=0;g<options.length;g++)if(options[g].tagName=="option"){var i=options[g].firstChild?options[g].firstChild.data:"";h[h.length]=[options[g].getAttribute("value"),i]}b.addOption(h);if(arguments.length==4)d.forEachRow(function(a){var c=d.cells(a,e);!c.cell._brval&& !c.cell.zk&&c.cell._cellIndex==e&&(c.cell.combo_value==""?c.setComboCValue("&nbsp;",""):b.acS(c.cell.combo_value)?c.setComboCValue(b.acS(c.cell.combo_value).text):c.setComboCValue(c.cell.combo_value))});else{var f=this.cell?this:d.cells(c,e);a.getAttribute("text")?a.getAttribute("text").PA()==""?f.setComboCValue("&nbsp;",""):f.setComboCValue(a.getAttribute("text")): !f.cell.combo_value||f.cell.combo_value.PA()==""?f.setComboCValue("&nbsp;",""):b.acS(f.cell.combo_value)?f.setComboCValue(b.acS(f.cell.combo_value).text):f.setComboCValue(f.cell.combo_value)}}if(a.getAttribute("source"))if(a.getAttribute("auto")&&ap(a.getAttribute("auto")))a.getAttribute("xmlcontent")?(f=this.cell?this:d.cells(c,e),a.getAttribute("text")&&f.setComboCValue(a.getAttribute("text"))):d.forEachRow(function(a){var b=d.cells(a,e);if(!b.cell._brval&& !b.cell.zk){var c=b.cell.combo_value.toString();if(c.indexOf("^")!= -1){var f=c.split("^");b.cell.combo_value=f[0];b.setComboCValue(f[1])}}}),b.fF(!0,a.getAttribute("source"),ap(a.getAttribute("cache")|| !0),ap(a.getAttribute("sub")|| !1));else{var k=this,j=arguments.length;b.loadXML(a.getAttribute("source"),function(){if(j==4)d.forEachRow(function(a){var c=d.cells(a,e);if(!c.cell._brval&& !c.cell.zk)b.acS(c.cell.combo_value)?c.setComboCValue(b.acS(c.cell.combo_value).text):(c.cell.combo_value||"").toString().PA()==""?(c.setComboCValue("&nbsp;",""),c.cell.mG= !0):c.setComboCValue(c.cell.combo_value)});else{var a=d.cells(c,e);b.acS(a.cell.combo_value)?a.setComboCValue(b.acS(a.cell.combo_value).text):a.setComboCValue(a.cell.combo_value)}})}if(!a.getAttribute("auto")|| !ap(a.getAttribute("auto")))a.getAttribute("editable")&& !ap(a.getAttribute("editable"))&&b.readonly(!0),a.getAttribute("filter")&&ap(a.getAttribute("filter"))&&b.fF(!0)};eXcell_combo.prototype.getCellCombo=function(){if(!this.cell._brval)this.cell._brval=this.initCombo();return this.cell._brval};dhtmlXGridObject.prototype.getColumnCombo=function(b){if(!this._col_combos|| !this._col_combos[b]){if(!this._col_combos)this._col_combos=[];this._col_combos[b]=eXcell_combo.prototype.initCombo.call({grid:this},b)}return this._col_combos[b]};